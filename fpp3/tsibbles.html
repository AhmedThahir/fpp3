<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.1 tsibble objects | Forecasting: Principles and Practice (3rd ed)</title>
  <meta name="description" content="3rd edition" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="2.1 tsibble objects | Forecasting: Principles and Practice (3rd ed)" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://Otexts.com/fpp3///figs/fpp3_front_cover.jpg" />
  <meta property="og:description" content="3rd edition" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.1 tsibble objects | Forecasting: Principles and Practice (3rd ed)" />
  <meta name="twitter:site" content="@robjhyndman" />
  <meta name="twitter:description" content="3rd edition" />
  <meta name="twitter:image" content="https://Otexts.com/fpp3///figs/fpp3_front_cover.jpg" />




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="graphics.html"/>
<link rel="next" href="time-plots.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { 
    equationNumbers: { autoNumber: "AMS" } ,
    Macros: {
      bm: ["\\boldsymbol{#1}",1],
      y:    ["y_{\\text{#1},#2}",2],
      yhat: ["\\hat{y}_{\\text{#1},#2}",2],
      ytilde: ["\\tilde{y}_{\\text{#1},#2}",2],
      Shat: ["\\hat{S}_{\\text{#1},#2}^{(#3)}",3]
    }
  }
});
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-27933797-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-27933797-2');
  gtag('config', 'G-JKBLG3XQGY');
</script>
<link href="https://fonts.googleapis.com/css?family=Fira+Sans|Merriweather" rel="stylesheet">
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hack-font@3/build/web/hack-subset.css">
<script>
  /*
   * Light YouTube Embeds by @labnol
   * Credit: https://www.labnol.org/
   */

  function labnolIframe(div) {
    var iframe = document.createElement('iframe');
    iframe.setAttribute('src', 'https://www.youtube.com/embed/' + div.dataset.id + '?autoplay=1');
    iframe.setAttribute('frameborder', '0');
    iframe.setAttribute('allowfullscreen', '1');
    iframe.setAttribute('allow', 'accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture');
    div.parentNode.replaceChild(iframe, div);
  }

  function initYouTubeVideos() {
    var playerElements = document.querySelectorAll('.youtube-player');
    for (var n = 0; n < playerElements.length; n++) {
      var videoId = playerElements[n].dataset.id;
      var div = document.createElement('div');
      div.setAttribute('data-id', videoId);
      var thumbNode = document.createElement('img');
      thumbNode.src = '//i.ytimg.com/vi/ID/hqdefault.jpg'.replace('ID', videoId);
      div.appendChild(thumbNode);
      var playButton = document.createElement('div');
      playButton.setAttribute('class', 'play');
      div.appendChild(playButton);
      div.onclick = function () {
        labnolIframe(this);
      };
      playerElements[n].appendChild(div);
    }
  }

  document.addEventListener('DOMContentLoaded', initYouTubeVideos);
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Forecasting: Principles and Practice</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Getting started</a>
<ul>
<li class="chapter" data-level="1.1" data-path="what-can-be-forecast.html"><a href="what-can-be-forecast.html"><i class="fa fa-check"></i><b>1.1</b> What can be forecast?</a></li>
<li class="chapter" data-level="1.2" data-path="planning.html"><a href="planning.html"><i class="fa fa-check"></i><b>1.2</b> Forecasting, goals and planning</a></li>
<li class="chapter" data-level="1.3" data-path="determining-what-to-forecast.html"><a href="determining-what-to-forecast.html"><i class="fa fa-check"></i><b>1.3</b> Determining what to forecast</a></li>
<li class="chapter" data-level="1.4" data-path="data-methods.html"><a href="data-methods.html"><i class="fa fa-check"></i><b>1.4</b> Forecasting data and methods</a></li>
<li class="chapter" data-level="1.5" data-path="case-studies.html"><a href="case-studies.html"><i class="fa fa-check"></i><b>1.5</b> Some case studies</a></li>
<li class="chapter" data-level="1.6" data-path="basic-steps.html"><a href="basic-steps.html"><i class="fa fa-check"></i><b>1.6</b> The basic steps in a forecasting task</a></li>
<li class="chapter" data-level="1.7" data-path="perspective.html"><a href="perspective.html"><i class="fa fa-check"></i><b>1.7</b> The statistical forecasting perspective</a></li>
<li class="chapter" data-level="1.8" data-path="intro-exercises.html"><a href="intro-exercises.html"><i class="fa fa-check"></i><b>1.8</b> Exercises</a></li>
<li class="chapter" data-level="1.9" data-path="intro-reading.html"><a href="intro-reading.html"><i class="fa fa-check"></i><b>1.9</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="graphics.html"><a href="graphics.html"><i class="fa fa-check"></i><b>2</b> Time series graphics</a>
<ul>
<li class="chapter" data-level="2.1" data-path="tsibbles.html"><a href="tsibbles.html"><i class="fa fa-check"></i><b>2.1</b> <code>tsibble</code> objects</a></li>
<li class="chapter" data-level="2.2" data-path="time-plots.html"><a href="time-plots.html"><i class="fa fa-check"></i><b>2.2</b> Time plots</a></li>
<li class="chapter" data-level="2.3" data-path="tspatterns.html"><a href="tspatterns.html"><i class="fa fa-check"></i><b>2.3</b> Time series patterns</a></li>
<li class="chapter" data-level="2.4" data-path="seasonal-plots.html"><a href="seasonal-plots.html"><i class="fa fa-check"></i><b>2.4</b> Seasonal plots</a></li>
<li class="chapter" data-level="2.5" data-path="subseries.html"><a href="subseries.html"><i class="fa fa-check"></i><b>2.5</b> Seasonal subseries plots</a></li>
<li class="chapter" data-level="2.6" data-path="scatterplots.html"><a href="scatterplots.html"><i class="fa fa-check"></i><b>2.6</b> Scatterplots</a></li>
<li class="chapter" data-level="2.7" data-path="lag-plots.html"><a href="lag-plots.html"><i class="fa fa-check"></i><b>2.7</b> Lag plots</a></li>
<li class="chapter" data-level="2.8" data-path="acf.html"><a href="acf.html"><i class="fa fa-check"></i><b>2.8</b> Autocorrelation</a></li>
<li class="chapter" data-level="2.9" data-path="wn.html"><a href="wn.html"><i class="fa fa-check"></i><b>2.9</b> White noise</a></li>
<li class="chapter" data-level="2.10" data-path="graphics-exercises.html"><a href="graphics-exercises.html"><i class="fa fa-check"></i><b>2.10</b> Exercises</a></li>
<li class="chapter" data-level="2.11" data-path="graphics-reading.html"><a href="graphics-reading.html"><i class="fa fa-check"></i><b>2.11</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="decomposition.html"><a href="decomposition.html"><i class="fa fa-check"></i><b>3</b> Time series decomposition</a>
<ul>
<li class="chapter" data-level="3.1" data-path="transformations.html"><a href="transformations.html"><i class="fa fa-check"></i><b>3.1</b> Transformations and adjustments</a></li>
<li class="chapter" data-level="3.2" data-path="components.html"><a href="components.html"><i class="fa fa-check"></i><b>3.2</b> Time series components</a></li>
<li class="chapter" data-level="3.3" data-path="moving-averages.html"><a href="moving-averages.html"><i class="fa fa-check"></i><b>3.3</b> Moving averages</a></li>
<li class="chapter" data-level="3.4" data-path="classical-decomposition.html"><a href="classical-decomposition.html"><i class="fa fa-check"></i><b>3.4</b> Classical decomposition</a></li>
<li class="chapter" data-level="3.5" data-path="methods-used-by-official-statistics-agencies.html"><a href="methods-used-by-official-statistics-agencies.html"><i class="fa fa-check"></i><b>3.5</b> Methods used by official statistics agencies</a></li>
<li class="chapter" data-level="3.6" data-path="stl.html"><a href="stl.html"><i class="fa fa-check"></i><b>3.6</b> STL decomposition</a></li>
<li class="chapter" data-level="3.7" data-path="decomposition-exercises.html"><a href="decomposition-exercises.html"><i class="fa fa-check"></i><b>3.7</b> Exercises</a></li>
<li class="chapter" data-level="3.8" data-path="decomposition-reading.html"><a href="decomposition-reading.html"><i class="fa fa-check"></i><b>3.8</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="features.html"><a href="features.html"><i class="fa fa-check"></i><b>4</b> Time series features</a>
<ul>
<li class="chapter" data-level="4.1" data-path="some-simple-statistics.html"><a href="some-simple-statistics.html"><i class="fa fa-check"></i><b>4.1</b> Some simple statistics</a></li>
<li class="chapter" data-level="4.2" data-path="acf-features.html"><a href="acf-features.html"><i class="fa fa-check"></i><b>4.2</b> ACF features</a></li>
<li class="chapter" data-level="4.3" data-path="stlfeatures.html"><a href="stlfeatures.html"><i class="fa fa-check"></i><b>4.3</b> STL Features</a></li>
<li class="chapter" data-level="4.4" data-path="other-features.html"><a href="other-features.html"><i class="fa fa-check"></i><b>4.4</b> Other features</a></li>
<li class="chapter" data-level="4.5" data-path="exploring-australian-tourism-data.html"><a href="exploring-australian-tourism-data.html"><i class="fa fa-check"></i><b>4.5</b> Exploring Australian tourism data</a></li>
<li class="chapter" data-level="4.6" data-path="feast-exercises.html"><a href="feast-exercises.html"><i class="fa fa-check"></i><b>4.6</b> Exercises</a></li>
<li class="chapter" data-level="4.7" data-path="further-reading.html"><a href="further-reading.html"><i class="fa fa-check"></i><b>4.7</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="toolbox.html"><a href="toolbox.html"><i class="fa fa-check"></i><b>5</b> The forecaster’s toolbox</a>
<ul>
<li class="chapter" data-level="5.1" data-path="a-tidy-forecasting-workflow.html"><a href="a-tidy-forecasting-workflow.html"><i class="fa fa-check"></i><b>5.1</b> A tidy forecasting workflow</a></li>
<li class="chapter" data-level="5.2" data-path="simple-methods.html"><a href="simple-methods.html"><i class="fa fa-check"></i><b>5.2</b> Some simple forecasting methods</a></li>
<li class="chapter" data-level="5.3" data-path="residuals.html"><a href="residuals.html"><i class="fa fa-check"></i><b>5.3</b> Fitted values and residuals</a></li>
<li class="chapter" data-level="5.4" data-path="diagnostics.html"><a href="diagnostics.html"><i class="fa fa-check"></i><b>5.4</b> Residual diagnostics</a></li>
<li class="chapter" data-level="5.5" data-path="prediction-intervals.html"><a href="prediction-intervals.html"><i class="fa fa-check"></i><b>5.5</b> Distributional forecasts and prediction intervals</a></li>
<li class="chapter" data-level="5.6" data-path="ftransformations.html"><a href="ftransformations.html"><i class="fa fa-check"></i><b>5.6</b> Forecasting using transformations</a></li>
<li class="chapter" data-level="5.7" data-path="forecasting-decomposition.html"><a href="forecasting-decomposition.html"><i class="fa fa-check"></i><b>5.7</b> Forecasting with decomposition</a></li>
<li class="chapter" data-level="5.8" data-path="accuracy.html"><a href="accuracy.html"><i class="fa fa-check"></i><b>5.8</b> Evaluating point forecast accuracy</a></li>
<li class="chapter" data-level="5.9" data-path="distaccuracy.html"><a href="distaccuracy.html"><i class="fa fa-check"></i><b>5.9</b> Evaluating distributional forecast accuracy</a></li>
<li class="chapter" data-level="5.10" data-path="tscv.html"><a href="tscv.html"><i class="fa fa-check"></i><b>5.10</b> Time series cross-validation</a></li>
<li class="chapter" data-level="5.11" data-path="toolbox-exercises.html"><a href="toolbox-exercises.html"><i class="fa fa-check"></i><b>5.11</b> Exercises</a></li>
<li class="chapter" data-level="5.12" data-path="basics-reading.html"><a href="basics-reading.html"><i class="fa fa-check"></i><b>5.12</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="judgmental.html"><a href="judgmental.html"><i class="fa fa-check"></i><b>6</b> Judgmental forecasts</a>
<ul>
<li class="chapter" data-level="6.1" data-path="judgmental-limitations.html"><a href="judgmental-limitations.html"><i class="fa fa-check"></i><b>6.1</b> Beware of limitations</a></li>
<li class="chapter" data-level="6.2" data-path="judgmental-principles.html"><a href="judgmental-principles.html"><i class="fa fa-check"></i><b>6.2</b> Key principles</a></li>
<li class="chapter" data-level="6.3" data-path="delphimethod.html"><a href="delphimethod.html"><i class="fa fa-check"></i><b>6.3</b> The Delphi method</a></li>
<li class="chapter" data-level="6.4" data-path="analogies.html"><a href="analogies.html"><i class="fa fa-check"></i><b>6.4</b> Forecasting by analogy</a></li>
<li class="chapter" data-level="6.5" data-path="scenarios.html"><a href="scenarios.html"><i class="fa fa-check"></i><b>6.5</b> Scenario forecasting</a></li>
<li class="chapter" data-level="6.6" data-path="new-products.html"><a href="new-products.html"><i class="fa fa-check"></i><b>6.6</b> New product forecasting</a></li>
<li class="chapter" data-level="6.7" data-path="judgmental-adjustments.html"><a href="judgmental-adjustments.html"><i class="fa fa-check"></i><b>6.7</b> Judgmental adjustments</a></li>
<li class="chapter" data-level="6.8" data-path="judgmental-reading.html"><a href="judgmental-reading.html"><i class="fa fa-check"></i><b>6.8</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>7</b> Time series regression models</a>
<ul>
<li class="chapter" data-level="7.1" data-path="regression-intro.html"><a href="regression-intro.html"><i class="fa fa-check"></i><b>7.1</b> The linear model</a></li>
<li class="chapter" data-level="7.2" data-path="least-squares.html"><a href="least-squares.html"><i class="fa fa-check"></i><b>7.2</b> Least squares estimation</a></li>
<li class="chapter" data-level="7.3" data-path="regression-evaluation.html"><a href="regression-evaluation.html"><i class="fa fa-check"></i><b>7.3</b> Evaluating the regression model</a></li>
<li class="chapter" data-level="7.4" data-path="useful-predictors.html"><a href="useful-predictors.html"><i class="fa fa-check"></i><b>7.4</b> Some useful predictors</a></li>
<li class="chapter" data-level="7.5" data-path="selecting-predictors.html"><a href="selecting-predictors.html"><i class="fa fa-check"></i><b>7.5</b> Selecting predictors</a></li>
<li class="chapter" data-level="7.6" data-path="forecasting-regression.html"><a href="forecasting-regression.html"><i class="fa fa-check"></i><b>7.6</b> Forecasting with regression</a></li>
<li class="chapter" data-level="7.7" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html"><i class="fa fa-check"></i><b>7.7</b> Nonlinear regression</a></li>
<li class="chapter" data-level="7.8" data-path="causality.html"><a href="causality.html"><i class="fa fa-check"></i><b>7.8</b> Correlation, causation and forecasting</a></li>
<li class="chapter" data-level="7.9" data-path="regression-matrices.html"><a href="regression-matrices.html"><i class="fa fa-check"></i><b>7.9</b> Matrix formulation</a></li>
<li class="chapter" data-level="7.10" data-path="regression-exercises.html"><a href="regression-exercises.html"><i class="fa fa-check"></i><b>7.10</b> Exercises</a></li>
<li class="chapter" data-level="7.11" data-path="regression-reading.html"><a href="regression-reading.html"><i class="fa fa-check"></i><b>7.11</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="expsmooth.html"><a href="expsmooth.html"><i class="fa fa-check"></i><b>8</b> Exponential smoothing</a>
<ul>
<li class="chapter" data-level="8.1" data-path="ses.html"><a href="ses.html"><i class="fa fa-check"></i><b>8.1</b> Simple exponential smoothing</a></li>
<li class="chapter" data-level="8.2" data-path="holt.html"><a href="holt.html"><i class="fa fa-check"></i><b>8.2</b> Methods with trend</a></li>
<li class="chapter" data-level="8.3" data-path="holt-winters.html"><a href="holt-winters.html"><i class="fa fa-check"></i><b>8.3</b> Methods with seasonality</a></li>
<li class="chapter" data-level="8.4" data-path="taxonomy.html"><a href="taxonomy.html"><i class="fa fa-check"></i><b>8.4</b> A taxonomy of exponential smoothing methods</a></li>
<li class="chapter" data-level="8.5" data-path="ets.html"><a href="ets.html"><i class="fa fa-check"></i><b>8.5</b> Innovations state space models for exponential smoothing</a></li>
<li class="chapter" data-level="8.6" data-path="ets-estimation.html"><a href="ets-estimation.html"><i class="fa fa-check"></i><b>8.6</b> Estimation and model selection</a></li>
<li class="chapter" data-level="8.7" data-path="ets-forecasting.html"><a href="ets-forecasting.html"><i class="fa fa-check"></i><b>8.7</b> Forecasting with ETS models</a></li>
<li class="chapter" data-level="8.8" data-path="expsmooth-exercises.html"><a href="expsmooth-exercises.html"><i class="fa fa-check"></i><b>8.8</b> Exercises</a></li>
<li class="chapter" data-level="8.9" data-path="expsmooth-reading.html"><a href="expsmooth-reading.html"><i class="fa fa-check"></i><b>8.9</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="arima.html"><a href="arima.html"><i class="fa fa-check"></i><b>9</b> ARIMA models</a>
<ul>
<li class="chapter" data-level="9.1" data-path="stationarity.html"><a href="stationarity.html"><i class="fa fa-check"></i><b>9.1</b> Stationarity and differencing</a></li>
<li class="chapter" data-level="9.2" data-path="backshift.html"><a href="backshift.html"><i class="fa fa-check"></i><b>9.2</b> Backshift notation</a></li>
<li class="chapter" data-level="9.3" data-path="AR.html"><a href="AR.html"><i class="fa fa-check"></i><b>9.3</b> Autoregressive models</a></li>
<li class="chapter" data-level="9.4" data-path="MA.html"><a href="MA.html"><i class="fa fa-check"></i><b>9.4</b> Moving average models</a></li>
<li class="chapter" data-level="9.5" data-path="non-seasonal-arima.html"><a href="non-seasonal-arima.html"><i class="fa fa-check"></i><b>9.5</b> Non-seasonal ARIMA models</a></li>
<li class="chapter" data-level="9.6" data-path="arima-estimation.html"><a href="arima-estimation.html"><i class="fa fa-check"></i><b>9.6</b> Estimation and order selection</a></li>
<li class="chapter" data-level="9.7" data-path="arima-r.html"><a href="arima-r.html"><i class="fa fa-check"></i><b>9.7</b> ARIMA modelling in <code>fable</code></a></li>
<li class="chapter" data-level="9.8" data-path="arima-forecasting.html"><a href="arima-forecasting.html"><i class="fa fa-check"></i><b>9.8</b> Forecasting</a></li>
<li class="chapter" data-level="9.9" data-path="seasonal-arima.html"><a href="seasonal-arima.html"><i class="fa fa-check"></i><b>9.9</b> Seasonal ARIMA models</a></li>
<li class="chapter" data-level="9.10" data-path="arima-ets.html"><a href="arima-ets.html"><i class="fa fa-check"></i><b>9.10</b> ARIMA vs ETS</a></li>
<li class="chapter" data-level="9.11" data-path="arima-exercises.html"><a href="arima-exercises.html"><i class="fa fa-check"></i><b>9.11</b> Exercises</a></li>
<li class="chapter" data-level="9.12" data-path="arima-reading.html"><a href="arima-reading.html"><i class="fa fa-check"></i><b>9.12</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="dynamic.html"><a href="dynamic.html"><i class="fa fa-check"></i><b>10</b> Dynamic regression models</a>
<ul>
<li class="chapter" data-level="10.1" data-path="estimation.html"><a href="estimation.html"><i class="fa fa-check"></i><b>10.1</b> Estimation</a></li>
<li class="chapter" data-level="10.2" data-path="regarima.html"><a href="regarima.html"><i class="fa fa-check"></i><b>10.2</b> Regression with ARIMA errors using <code>fable</code></a></li>
<li class="chapter" data-level="10.3" data-path="forecasting.html"><a href="forecasting.html"><i class="fa fa-check"></i><b>10.3</b> Forecasting</a></li>
<li class="chapter" data-level="10.4" data-path="stochastic-and-deterministic-trends.html"><a href="stochastic-and-deterministic-trends.html"><i class="fa fa-check"></i><b>10.4</b> Stochastic and deterministic trends</a></li>
<li class="chapter" data-level="10.5" data-path="dhr.html"><a href="dhr.html"><i class="fa fa-check"></i><b>10.5</b> Dynamic harmonic regression</a></li>
<li class="chapter" data-level="10.6" data-path="lagged-predictors.html"><a href="lagged-predictors.html"><i class="fa fa-check"></i><b>10.6</b> Lagged predictors</a></li>
<li class="chapter" data-level="10.7" data-path="dynamic-exercises.html"><a href="dynamic-exercises.html"><i class="fa fa-check"></i><b>10.7</b> Exercises</a></li>
<li class="chapter" data-level="10.8" data-path="dynamic-reading.html"><a href="dynamic-reading.html"><i class="fa fa-check"></i><b>10.8</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="hierarchical.html"><a href="hierarchical.html"><i class="fa fa-check"></i><b>11</b> Forecasting hierarchical and grouped time series</a>
<ul>
<li class="chapter" data-level="11.1" data-path="hts.html"><a href="hts.html"><i class="fa fa-check"></i><b>11.1</b> Hierarchical and grouped time series</a></li>
<li class="chapter" data-level="11.2" data-path="single-level.html"><a href="single-level.html"><i class="fa fa-check"></i><b>11.2</b> Single level approaches</a></li>
<li class="chapter" data-level="11.3" data-path="reconciliation.html"><a href="reconciliation.html"><i class="fa fa-check"></i><b>11.3</b> Forecast reconciliation</a></li>
<li class="chapter" data-level="11.4" data-path="tourism.html"><a href="tourism.html"><i class="fa fa-check"></i><b>11.4</b> Forecasting Australian domestic tourism</a></li>
<li class="chapter" data-level="11.5" data-path="rec-prob.html"><a href="rec-prob.html"><i class="fa fa-check"></i><b>11.5</b> Reconciled distributional forecasts</a></li>
<li class="chapter" data-level="11.6" data-path="prison.html"><a href="prison.html"><i class="fa fa-check"></i><b>11.6</b> Forecasting Australian prison population</a></li>
<li class="chapter" data-level="11.7" data-path="hierarchical-exercises.html"><a href="hierarchical-exercises.html"><i class="fa fa-check"></i><b>11.7</b> Exercises</a></li>
<li class="chapter" data-level="11.8" data-path="hierarchical-reading.html"><a href="hierarchical-reading.html"><i class="fa fa-check"></i><b>11.8</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="advanced.html"><a href="advanced.html"><i class="fa fa-check"></i><b>12</b> Advanced forecasting methods</a>
<ul>
<li class="chapter" data-level="12.1" data-path="complexseasonality.html"><a href="complexseasonality.html"><i class="fa fa-check"></i><b>12.1</b> Complex seasonality</a></li>
<li class="chapter" data-level="12.2" data-path="prophet.html"><a href="prophet.html"><i class="fa fa-check"></i><b>12.2</b> Prophet model</a></li>
<li class="chapter" data-level="12.3" data-path="VAR.html"><a href="VAR.html"><i class="fa fa-check"></i><b>12.3</b> Vector autoregressions</a></li>
<li class="chapter" data-level="12.4" data-path="nnetar.html"><a href="nnetar.html"><i class="fa fa-check"></i><b>12.4</b> Neural network models</a></li>
<li class="chapter" data-level="12.5" data-path="bootstrap.html"><a href="bootstrap.html"><i class="fa fa-check"></i><b>12.5</b> Bootstrapping and bagging</a></li>
<li class="chapter" data-level="12.6" data-path="advanced-exercises.html"><a href="advanced-exercises.html"><i class="fa fa-check"></i><b>12.6</b> Exercises</a></li>
<li class="chapter" data-level="12.7" data-path="advanced-reading.html"><a href="advanced-reading.html"><i class="fa fa-check"></i><b>12.7</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="practical.html"><a href="practical.html"><i class="fa fa-check"></i><b>13</b> Some practical forecasting issues</a>
<ul>
<li class="chapter" data-level="13.1" data-path="weekly.html"><a href="weekly.html"><i class="fa fa-check"></i><b>13.1</b> Weekly, daily and sub-daily data</a></li>
<li class="chapter" data-level="13.2" data-path="counts.html"><a href="counts.html"><i class="fa fa-check"></i><b>13.2</b> Time series of counts</a></li>
<li class="chapter" data-level="13.3" data-path="limits.html"><a href="limits.html"><i class="fa fa-check"></i><b>13.3</b> Ensuring forecasts stay within limits</a></li>
<li class="chapter" data-level="13.4" data-path="combinations.html"><a href="combinations.html"><i class="fa fa-check"></i><b>13.4</b> Forecast combinations</a></li>
<li class="chapter" data-level="13.5" data-path="aggregates.html"><a href="aggregates.html"><i class="fa fa-check"></i><b>13.5</b> Prediction intervals for aggregates</a></li>
<li class="chapter" data-level="13.6" data-path="backcasting.html"><a href="backcasting.html"><i class="fa fa-check"></i><b>13.6</b> Backcasting</a></li>
<li class="chapter" data-level="13.7" data-path="long-short-ts.html"><a href="long-short-ts.html"><i class="fa fa-check"></i><b>13.7</b> Very long and very short time series</a></li>
<li class="chapter" data-level="13.8" data-path="training-test.html"><a href="training-test.html"><i class="fa fa-check"></i><b>13.8</b> Forecasting on training and test sets</a></li>
<li class="chapter" data-level="13.9" data-path="missing-outliers.html"><a href="missing-outliers.html"><i class="fa fa-check"></i><b>13.9</b> Dealing with outliers and missing values</a></li>
<li class="chapter" data-level="13.10" data-path="further-reading-1.html"><a href="further-reading-1.html"><i class="fa fa-check"></i><b>13.10</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-using-r.html"><a href="appendix-using-r.html"><i class="fa fa-check"></i>Appendix: Using R</a></li>
<li class="chapter" data-level="" data-path="appendix-for-instructors.html"><a href="appendix-for-instructors.html"><i class="fa fa-check"></i>Appendix: For instructors</a></li>
<li class="chapter" data-level="" data-path="appendix-reviews.html"><a href="appendix-reviews.html"><i class="fa fa-check"></i>Appendix: Reviews</a></li>
<li class="chapter" data-level="" data-path="translations.html"><a href="translations.html"><i class="fa fa-check"></i>Translations</a></li>
<li class="chapter" data-level="" data-path="about-the-authors.html"><a href="about-the-authors.html"><i class="fa fa-check"></i>About the authors</a></li>
<li class="chapter" data-level="" data-path="buy-a-print-version.html"><a href="buy-a-print-version.html"><i class="fa fa-check"></i>Buy a print version</a></li>
<li class="chapter" data-level="" data-path="report-an-error.html"><a href="report-an-error.html"><i class="fa fa-check"></i>Report an error</a></li>
<li class="chapter" data-level="" data-path="bibliography.html"><a href="bibliography.html"><i class="fa fa-check"></i>Bibliography</a></li>
<li class="divider"></li>
<li><a href="https://OTexts.com" target="blank">Published by OTexts™ with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Forecasting: Principles and Practice <font size=-1>(3rd ed)</font></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tsibbles" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> <code>tsibble</code> objects<a href="tsibbles.html#tsibbles" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="youtube-player" data-id="EwjvA2OcdHs">

</div>
<p>A time series can be thought of as a list of numbers (the measurements), along with some information about what times those numbers were recorded (the index). This information can be stored as a <code>tsibble</code> object in R.</p>
<div id="the-index-variable" class="section level3 unnumbered hasAnchor">
<h3>The index variable<a href="tsibbles.html#the-index-variable" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Suppose you have annual observations for the last few years:</p>
<table>
<thead>
<tr class="header">
<th align="right">Year</th>
<th align="right">Observation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">2015</td>
<td align="right">123</td>
</tr>
<tr class="even">
<td align="right">2016</td>
<td align="right">39</td>
</tr>
<tr class="odd">
<td align="right">2017</td>
<td align="right">78</td>
</tr>
<tr class="even">
<td align="right">2018</td>
<td align="right">52</td>
</tr>
<tr class="odd">
<td align="right">2019</td>
<td align="right">110</td>
</tr>
</tbody>
</table>
<p>We turn this into a <code>tsibble</code> object using the <code>tsibble()</code> function:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="tsibbles.html#cb3-1" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">tsibble</span>(</span>
<span id="cb3-2"><a href="tsibbles.html#cb3-2" tabindex="-1"></a>  <span class="at">Year =</span> <span class="dv">2015</span><span class="sc">:</span><span class="dv">2019</span>,</span>
<span id="cb3-3"><a href="tsibbles.html#cb3-3" tabindex="-1"></a>  <span class="at">Observation =</span> <span class="fu">c</span>(<span class="dv">123</span>, <span class="dv">39</span>, <span class="dv">78</span>, <span class="dv">52</span>, <span class="dv">110</span>),</span>
<span id="cb3-4"><a href="tsibbles.html#cb3-4" tabindex="-1"></a>  <span class="at">index =</span> Year</span>
<span id="cb3-5"><a href="tsibbles.html#cb3-5" tabindex="-1"></a>)</span></code></pre></div>
<p><code>tsibble</code> objects extend tidy data frames (<code>tibble</code> objects) by introducing temporal structure. We have set the time series <code>index</code> to be the <code>Year</code> column, which associates the measurements (<code>Observation</code>) with the time of recording (<code>Year</code>).</p>
<p>For observations that are more frequent than once per year, we need to use a time class function on the index. For example, suppose we have a monthly dataset <code>z</code>: </p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="tsibbles.html#cb4-1" tabindex="-1"></a>z</span>
<span id="cb4-2"><a href="tsibbles.html#cb4-2" tabindex="-1"></a><span class="co">#&gt; # A tibble: 5 × 2</span></span>
<span id="cb4-3"><a href="tsibbles.html#cb4-3" tabindex="-1"></a><span class="co">#&gt;   Month    Observation</span></span>
<span id="cb4-4"><a href="tsibbles.html#cb4-4" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;          &lt;dbl&gt;</span></span>
<span id="cb4-5"><a href="tsibbles.html#cb4-5" tabindex="-1"></a><span class="co">#&gt; 1 2019 Jan          50</span></span>
<span id="cb4-6"><a href="tsibbles.html#cb4-6" tabindex="-1"></a><span class="co">#&gt; 2 2019 Feb          23</span></span>
<span id="cb4-7"><a href="tsibbles.html#cb4-7" tabindex="-1"></a><span class="co">#&gt; 3 2019 Mar          34</span></span>
<span id="cb4-8"><a href="tsibbles.html#cb4-8" tabindex="-1"></a><span class="co">#&gt; 4 2019 Apr          30</span></span>
<span id="cb4-9"><a href="tsibbles.html#cb4-9" tabindex="-1"></a><span class="co">#&gt; 5 2019 May          25</span></span></code></pre></div>
<p>This can be converted to a <code>tsibble</code> object using the following code:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="tsibbles.html#cb5-1" tabindex="-1"></a>z <span class="sc">|&gt;</span></span>
<span id="cb5-2"><a href="tsibbles.html#cb5-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Month =</span> <span class="fu">yearmonth</span>(Month)) <span class="sc">|&gt;</span></span>
<span id="cb5-3"><a href="tsibbles.html#cb5-3" tabindex="-1"></a>  <span class="fu">as_tsibble</span>(<span class="at">index =</span> Month)</span>
<span id="cb5-4"><a href="tsibbles.html#cb5-4" tabindex="-1"></a><span class="co">#&gt; # A tsibble: 5 x 2 [1M]</span></span>
<span id="cb5-5"><a href="tsibbles.html#cb5-5" tabindex="-1"></a><span class="co">#&gt;      Month Observation</span></span>
<span id="cb5-6"><a href="tsibbles.html#cb5-6" tabindex="-1"></a><span class="co">#&gt;      &lt;mth&gt;       &lt;dbl&gt;</span></span>
<span id="cb5-7"><a href="tsibbles.html#cb5-7" tabindex="-1"></a><span class="co">#&gt; 1 2019 Jan          50</span></span>
<span id="cb5-8"><a href="tsibbles.html#cb5-8" tabindex="-1"></a><span class="co">#&gt; 2 2019 Feb          23</span></span>
<span id="cb5-9"><a href="tsibbles.html#cb5-9" tabindex="-1"></a><span class="co">#&gt; 3 2019 Mar          34</span></span>
<span id="cb5-10"><a href="tsibbles.html#cb5-10" tabindex="-1"></a><span class="co">#&gt; 4 2019 Apr          30</span></span>
<span id="cb5-11"><a href="tsibbles.html#cb5-11" tabindex="-1"></a><span class="co">#&gt; 5 2019 May          25</span></span></code></pre></div>
<p>First, the <code>Month</code> column is being converted from text to a monthly time object with <code>yearmonth()</code>. We then convert the data frame to a <code>tsibble</code> by identifying the <code>index</code> variable using <code>as_tsibble()</code>. Note the addition of “[1M]” on the first line indicating this is monthly data.</p>
<p>Other time class functions can be used depending on the frequency of the observations.</p>
<table>
<thead>
<tr class="header">
<th align="left">Frequency</th>
<th align="left">Function</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Annual</td>
<td align="left"><code>start:end</code></td>
</tr>
<tr class="even">
<td align="left">Quarterly</td>
<td align="left"><code>yearquarter()</code></td>
</tr>
<tr class="odd">
<td align="left">Monthly</td>
<td align="left"><code>yearmonth()</code></td>
</tr>
<tr class="even">
<td align="left">Weekly</td>
<td align="left"><code>yearweek()</code></td>
</tr>
<tr class="odd">
<td align="left">Daily</td>
<td align="left"><code>as_date()</code>, <code>ymd()</code></td>
</tr>
<tr class="even">
<td align="left">Sub-daily</td>
<td align="left"><code>as_datetime()</code>, <code>ymd_hms()</code></td>
</tr>
</tbody>
</table>
</div>
<div id="the-key-variables" class="section level3 unnumbered hasAnchor">
<h3>The key variables<a href="tsibbles.html#the-key-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A <code>tsibble</code> also allows multiple time series to be stored in a single object. Suppose you are interested in a dataset containing the fastest running times for women’s and men’s track races at the Olympics, from 100m to 10000m:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="tsibbles.html#cb6-1" tabindex="-1"></a>olympic_running</span>
<span id="cb6-2"><a href="tsibbles.html#cb6-2" tabindex="-1"></a><span class="co">#&gt; # A tsibble: 312 x 4 [4Y]</span></span>
<span id="cb6-3"><a href="tsibbles.html#cb6-3" tabindex="-1"></a><span class="co">#&gt; # Key:       Length, Sex [14]</span></span>
<span id="cb6-4"><a href="tsibbles.html#cb6-4" tabindex="-1"></a><span class="co">#&gt;     Year Length Sex    Time</span></span>
<span id="cb6-5"><a href="tsibbles.html#cb6-5" tabindex="-1"></a><span class="co">#&gt;    &lt;int&gt;  &lt;int&gt; &lt;chr&gt; &lt;dbl&gt;</span></span>
<span id="cb6-6"><a href="tsibbles.html#cb6-6" tabindex="-1"></a><span class="co">#&gt;  1  1896    100 men    12  </span></span>
<span id="cb6-7"><a href="tsibbles.html#cb6-7" tabindex="-1"></a><span class="co">#&gt;  2  1900    100 men    11  </span></span>
<span id="cb6-8"><a href="tsibbles.html#cb6-8" tabindex="-1"></a><span class="co">#&gt;  3  1904    100 men    11  </span></span>
<span id="cb6-9"><a href="tsibbles.html#cb6-9" tabindex="-1"></a><span class="co">#&gt;  4  1908    100 men    10.8</span></span>
<span id="cb6-10"><a href="tsibbles.html#cb6-10" tabindex="-1"></a><span class="co">#&gt;  5  1912    100 men    10.8</span></span>
<span id="cb6-11"><a href="tsibbles.html#cb6-11" tabindex="-1"></a><span class="co">#&gt;  6  1916    100 men    NA  </span></span>
<span id="cb6-12"><a href="tsibbles.html#cb6-12" tabindex="-1"></a><span class="co">#&gt;  7  1920    100 men    10.8</span></span>
<span id="cb6-13"><a href="tsibbles.html#cb6-13" tabindex="-1"></a><span class="co">#&gt;  8  1924    100 men    10.6</span></span>
<span id="cb6-14"><a href="tsibbles.html#cb6-14" tabindex="-1"></a><span class="co">#&gt;  9  1928    100 men    10.8</span></span>
<span id="cb6-15"><a href="tsibbles.html#cb6-15" tabindex="-1"></a><span class="co">#&gt; 10  1932    100 men    10.3</span></span>
<span id="cb6-16"><a href="tsibbles.html#cb6-16" tabindex="-1"></a><span class="co">#&gt; # ℹ 302 more rows</span></span></code></pre></div>
<p>The summary above shows that this is a <code>tsibble</code> object, which contains 312 rows and 4 columns. Alongside this, “[4Y]” informs us that the interval of these observations is every four years. Below this is the key structure, which informs us that there are 14 separate time series in the <code>tsibble</code>. A preview of the first 10 observations is also shown, in which we can see a missing value occurs in 1916. This is because the Olympics were not held during World War I.</p>
<p>The 14 time series in this object are uniquely identified by the keys: the <code>Length</code> and <code>Sex</code> variables. The <code>distinct()</code> function can be used to show the categories of each variable or even combinations of variables:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="tsibbles.html#cb7-1" tabindex="-1"></a>olympic_running <span class="sc">|&gt;</span> <span class="fu">distinct</span>(Sex)</span>
<span id="cb7-2"><a href="tsibbles.html#cb7-2" tabindex="-1"></a><span class="co">#&gt; # A tibble: 2 × 1</span></span>
<span id="cb7-3"><a href="tsibbles.html#cb7-3" tabindex="-1"></a><span class="co">#&gt;   Sex  </span></span>
<span id="cb7-4"><a href="tsibbles.html#cb7-4" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;</span></span>
<span id="cb7-5"><a href="tsibbles.html#cb7-5" tabindex="-1"></a><span class="co">#&gt; 1 men  </span></span>
<span id="cb7-6"><a href="tsibbles.html#cb7-6" tabindex="-1"></a><span class="co">#&gt; 2 women</span></span></code></pre></div>
</div>
<div id="working-with-tsibble-objects" class="section level3 unnumbered hasAnchor">
<h3>Working with <code>tsibble</code> objects<a href="tsibbles.html#working-with-tsibble-objects" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can use <code>dplyr</code> functions such as <code>mutate()</code>, <code>filter()</code>, <code>select()</code> and <code>summarise()</code> to work with <code>tsibble</code> objects. To illustrate these, we will use the <code>PBS</code> tsibble containing sales data on pharmaceutical products in Australia.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="tsibbles.html#cb8-1" tabindex="-1"></a>PBS</span>
<span id="cb8-2"><a href="tsibbles.html#cb8-2" tabindex="-1"></a><span class="co">#&gt; # A tsibble: 67,596 x 9 [1M]</span></span>
<span id="cb8-3"><a href="tsibbles.html#cb8-3" tabindex="-1"></a><span class="co">#&gt; # Key:       Concession, Type, ATC1, ATC2 [336]</span></span>
<span id="cb8-4"><a href="tsibbles.html#cb8-4" tabindex="-1"></a><span class="co">#&gt;       Month Concession   Type    ATC1  ATC1_desc ATC2  ATC2_desc Scripts  Cost</span></span>
<span id="cb8-5"><a href="tsibbles.html#cb8-5" tabindex="-1"></a><span class="co">#&gt;       &lt;mth&gt; &lt;chr&gt;        &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb8-6"><a href="tsibbles.html#cb8-6" tabindex="-1"></a><span class="co">#&gt;  1 1991 Jul Concessional Co-pay… A     Alimenta… A01   STOMATOL…   18228 67877</span></span>
<span id="cb8-7"><a href="tsibbles.html#cb8-7" tabindex="-1"></a><span class="co">#&gt;  2 1991 Aug Concessional Co-pay… A     Alimenta… A01   STOMATOL…   15327 57011</span></span>
<span id="cb8-8"><a href="tsibbles.html#cb8-8" tabindex="-1"></a><span class="co">#&gt;  3 1991 Sep Concessional Co-pay… A     Alimenta… A01   STOMATOL…   14775 55020</span></span>
<span id="cb8-9"><a href="tsibbles.html#cb8-9" tabindex="-1"></a><span class="co">#&gt;  4 1991 Oct Concessional Co-pay… A     Alimenta… A01   STOMATOL…   15380 57222</span></span>
<span id="cb8-10"><a href="tsibbles.html#cb8-10" tabindex="-1"></a><span class="co">#&gt;  5 1991 Nov Concessional Co-pay… A     Alimenta… A01   STOMATOL…   14371 52120</span></span>
<span id="cb8-11"><a href="tsibbles.html#cb8-11" tabindex="-1"></a><span class="co">#&gt;  6 1991 Dec Concessional Co-pay… A     Alimenta… A01   STOMATOL…   15028 54299</span></span>
<span id="cb8-12"><a href="tsibbles.html#cb8-12" tabindex="-1"></a><span class="co">#&gt;  7 1992 Jan Concessional Co-pay… A     Alimenta… A01   STOMATOL…   11040 39753</span></span>
<span id="cb8-13"><a href="tsibbles.html#cb8-13" tabindex="-1"></a><span class="co">#&gt;  8 1992 Feb Concessional Co-pay… A     Alimenta… A01   STOMATOL…   15165 54405</span></span>
<span id="cb8-14"><a href="tsibbles.html#cb8-14" tabindex="-1"></a><span class="co">#&gt;  9 1992 Mar Concessional Co-pay… A     Alimenta… A01   STOMATOL…   16898 61108</span></span>
<span id="cb8-15"><a href="tsibbles.html#cb8-15" tabindex="-1"></a><span class="co">#&gt; 10 1992 Apr Concessional Co-pay… A     Alimenta… A01   STOMATOL…   18141 65356</span></span>
<span id="cb8-16"><a href="tsibbles.html#cb8-16" tabindex="-1"></a><span class="co">#&gt; # ℹ 67,586 more rows</span></span></code></pre></div>
<p>This contains monthly data on Medicare Australia prescription data from July 1991 to June 2008. These are classified according to various concession types, and Anatomical Therapeutic Chemical (ATC) indexes. For this example, we are interested in the <code>Cost</code> time series (total cost of scripts in Australian dollars).</p>
<p>We can use the <code>filter()</code> function to extract the A10 scripts:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="tsibbles.html#cb9-1" tabindex="-1"></a>PBS <span class="sc">|&gt;</span></span>
<span id="cb9-2"><a href="tsibbles.html#cb9-2" tabindex="-1"></a>  <span class="fu">filter</span>(ATC2 <span class="sc">==</span> <span class="st">&quot;A10&quot;</span>)</span>
<span id="cb9-3"><a href="tsibbles.html#cb9-3" tabindex="-1"></a><span class="co">#&gt; # A tsibble: 816 x 9 [1M]</span></span>
<span id="cb9-4"><a href="tsibbles.html#cb9-4" tabindex="-1"></a><span class="co">#&gt; # Key:       Concession, Type, ATC1, ATC2 [4]</span></span>
<span id="cb9-5"><a href="tsibbles.html#cb9-5" tabindex="-1"></a><span class="co">#&gt;       Month Concession   Type   ATC1  ATC1_desc ATC2  ATC2_desc Scripts   Cost</span></span>
<span id="cb9-6"><a href="tsibbles.html#cb9-6" tabindex="-1"></a><span class="co">#&gt;       &lt;mth&gt; &lt;chr&gt;        &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span id="cb9-7"><a href="tsibbles.html#cb9-7" tabindex="-1"></a><span class="co">#&gt;  1 1991 Jul Concessional Co-pa… A     Alimenta… A10   ANTIDIAB…   89733 2.09e6</span></span>
<span id="cb9-8"><a href="tsibbles.html#cb9-8" tabindex="-1"></a><span class="co">#&gt;  2 1991 Aug Concessional Co-pa… A     Alimenta… A10   ANTIDIAB…   77101 1.80e6</span></span>
<span id="cb9-9"><a href="tsibbles.html#cb9-9" tabindex="-1"></a><span class="co">#&gt;  3 1991 Sep Concessional Co-pa… A     Alimenta… A10   ANTIDIAB…   76255 1.78e6</span></span>
<span id="cb9-10"><a href="tsibbles.html#cb9-10" tabindex="-1"></a><span class="co">#&gt;  4 1991 Oct Concessional Co-pa… A     Alimenta… A10   ANTIDIAB…   78681 1.85e6</span></span>
<span id="cb9-11"><a href="tsibbles.html#cb9-11" tabindex="-1"></a><span class="co">#&gt;  5 1991 Nov Concessional Co-pa… A     Alimenta… A10   ANTIDIAB…   70554 1.69e6</span></span>
<span id="cb9-12"><a href="tsibbles.html#cb9-12" tabindex="-1"></a><span class="co">#&gt;  6 1991 Dec Concessional Co-pa… A     Alimenta… A10   ANTIDIAB…   75814 1.84e6</span></span>
<span id="cb9-13"><a href="tsibbles.html#cb9-13" tabindex="-1"></a><span class="co">#&gt;  7 1992 Jan Concessional Co-pa… A     Alimenta… A10   ANTIDIAB…   64186 1.56e6</span></span>
<span id="cb9-14"><a href="tsibbles.html#cb9-14" tabindex="-1"></a><span class="co">#&gt;  8 1992 Feb Concessional Co-pa… A     Alimenta… A10   ANTIDIAB…   75899 1.73e6</span></span>
<span id="cb9-15"><a href="tsibbles.html#cb9-15" tabindex="-1"></a><span class="co">#&gt;  9 1992 Mar Concessional Co-pa… A     Alimenta… A10   ANTIDIAB…   89445 2.05e6</span></span>
<span id="cb9-16"><a href="tsibbles.html#cb9-16" tabindex="-1"></a><span class="co">#&gt; 10 1992 Apr Concessional Co-pa… A     Alimenta… A10   ANTIDIAB…   97315 2.23e6</span></span>
<span id="cb9-17"><a href="tsibbles.html#cb9-17" tabindex="-1"></a><span class="co">#&gt; # ℹ 806 more rows</span></span></code></pre></div>
<p>This allows rows of the tsibble to be selected. Next we can simplify the resulting object by selecting the columns we will need in subsequent analysis.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="tsibbles.html#cb10-1" tabindex="-1"></a>PBS <span class="sc">|&gt;</span></span>
<span id="cb10-2"><a href="tsibbles.html#cb10-2" tabindex="-1"></a>  <span class="fu">filter</span>(ATC2 <span class="sc">==</span> <span class="st">&quot;A10&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb10-3"><a href="tsibbles.html#cb10-3" tabindex="-1"></a>  <span class="fu">select</span>(Month, Concession, Type, Cost)</span>
<span id="cb10-4"><a href="tsibbles.html#cb10-4" tabindex="-1"></a><span class="co">#&gt; # A tsibble: 816 x 4 [1M]</span></span>
<span id="cb10-5"><a href="tsibbles.html#cb10-5" tabindex="-1"></a><span class="co">#&gt; # Key:       Concession, Type [4]</span></span>
<span id="cb10-6"><a href="tsibbles.html#cb10-6" tabindex="-1"></a><span class="co">#&gt;       Month Concession   Type           Cost</span></span>
<span id="cb10-7"><a href="tsibbles.html#cb10-7" tabindex="-1"></a><span class="co">#&gt;       &lt;mth&gt; &lt;chr&gt;        &lt;chr&gt;         &lt;dbl&gt;</span></span>
<span id="cb10-8"><a href="tsibbles.html#cb10-8" tabindex="-1"></a><span class="co">#&gt;  1 1991 Jul Concessional Co-payments 2092878</span></span>
<span id="cb10-9"><a href="tsibbles.html#cb10-9" tabindex="-1"></a><span class="co">#&gt;  2 1991 Aug Concessional Co-payments 1795733</span></span>
<span id="cb10-10"><a href="tsibbles.html#cb10-10" tabindex="-1"></a><span class="co">#&gt;  3 1991 Sep Concessional Co-payments 1777231</span></span>
<span id="cb10-11"><a href="tsibbles.html#cb10-11" tabindex="-1"></a><span class="co">#&gt;  4 1991 Oct Concessional Co-payments 1848507</span></span>
<span id="cb10-12"><a href="tsibbles.html#cb10-12" tabindex="-1"></a><span class="co">#&gt;  5 1991 Nov Concessional Co-payments 1686458</span></span>
<span id="cb10-13"><a href="tsibbles.html#cb10-13" tabindex="-1"></a><span class="co">#&gt;  6 1991 Dec Concessional Co-payments 1843079</span></span>
<span id="cb10-14"><a href="tsibbles.html#cb10-14" tabindex="-1"></a><span class="co">#&gt;  7 1992 Jan Concessional Co-payments 1564702</span></span>
<span id="cb10-15"><a href="tsibbles.html#cb10-15" tabindex="-1"></a><span class="co">#&gt;  8 1992 Feb Concessional Co-payments 1732508</span></span>
<span id="cb10-16"><a href="tsibbles.html#cb10-16" tabindex="-1"></a><span class="co">#&gt;  9 1992 Mar Concessional Co-payments 2046102</span></span>
<span id="cb10-17"><a href="tsibbles.html#cb10-17" tabindex="-1"></a><span class="co">#&gt; 10 1992 Apr Concessional Co-payments 2225977</span></span>
<span id="cb10-18"><a href="tsibbles.html#cb10-18" tabindex="-1"></a><span class="co">#&gt; # ℹ 806 more rows</span></span></code></pre></div>
<p>The <code>select()</code> function allows us to select particular columns, while <code>filter()</code> allows us to keep particular rows.</p>
<p>Note that the index variable <code>Month</code>, and the keys <code>Concession</code> and <code>Type</code>, would be returned even if they were not explicitly selected as they are required for a tsibble (to ensure each row contains a unique combination of keys and index).</p>
<p>Another useful function is <code>summarise()</code> which allows us to combine data across keys. For example, we may wish to compute total cost per month regardless of the <code>Concession</code> or <code>Type</code> keys.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="tsibbles.html#cb11-1" tabindex="-1"></a>PBS <span class="sc">|&gt;</span></span>
<span id="cb11-2"><a href="tsibbles.html#cb11-2" tabindex="-1"></a>  <span class="fu">filter</span>(ATC2 <span class="sc">==</span> <span class="st">&quot;A10&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb11-3"><a href="tsibbles.html#cb11-3" tabindex="-1"></a>  <span class="fu">select</span>(Month, Concession, Type, Cost) <span class="sc">|&gt;</span></span>
<span id="cb11-4"><a href="tsibbles.html#cb11-4" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TotalC =</span> <span class="fu">sum</span>(Cost))</span>
<span id="cb11-5"><a href="tsibbles.html#cb11-5" tabindex="-1"></a><span class="co">#&gt; # A tsibble: 204 x 2 [1M]</span></span>
<span id="cb11-6"><a href="tsibbles.html#cb11-6" tabindex="-1"></a><span class="co">#&gt;       Month  TotalC</span></span>
<span id="cb11-7"><a href="tsibbles.html#cb11-7" tabindex="-1"></a><span class="co">#&gt;       &lt;mth&gt;   &lt;dbl&gt;</span></span>
<span id="cb11-8"><a href="tsibbles.html#cb11-8" tabindex="-1"></a><span class="co">#&gt;  1 1991 Jul 3526591</span></span>
<span id="cb11-9"><a href="tsibbles.html#cb11-9" tabindex="-1"></a><span class="co">#&gt;  2 1991 Aug 3180891</span></span>
<span id="cb11-10"><a href="tsibbles.html#cb11-10" tabindex="-1"></a><span class="co">#&gt;  3 1991 Sep 3252221</span></span>
<span id="cb11-11"><a href="tsibbles.html#cb11-11" tabindex="-1"></a><span class="co">#&gt;  4 1991 Oct 3611003</span></span>
<span id="cb11-12"><a href="tsibbles.html#cb11-12" tabindex="-1"></a><span class="co">#&gt;  5 1991 Nov 3565869</span></span>
<span id="cb11-13"><a href="tsibbles.html#cb11-13" tabindex="-1"></a><span class="co">#&gt;  6 1991 Dec 4306371</span></span>
<span id="cb11-14"><a href="tsibbles.html#cb11-14" tabindex="-1"></a><span class="co">#&gt;  7 1992 Jan 5088335</span></span>
<span id="cb11-15"><a href="tsibbles.html#cb11-15" tabindex="-1"></a><span class="co">#&gt;  8 1992 Feb 2814520</span></span>
<span id="cb11-16"><a href="tsibbles.html#cb11-16" tabindex="-1"></a><span class="co">#&gt;  9 1992 Mar 2985811</span></span>
<span id="cb11-17"><a href="tsibbles.html#cb11-17" tabindex="-1"></a><span class="co">#&gt; 10 1992 Apr 3204780</span></span>
<span id="cb11-18"><a href="tsibbles.html#cb11-18" tabindex="-1"></a><span class="co">#&gt; # ℹ 194 more rows</span></span></code></pre></div>
<p>The new variable <code>TotalC</code> is the sum of all <code>Cost</code> values for each month.</p>
<p>We can create new variables using the <code>mutate()</code> function. Here we change the units from dollars to millions of dollars:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="tsibbles.html#cb12-1" tabindex="-1"></a>PBS <span class="sc">|&gt;</span></span>
<span id="cb12-2"><a href="tsibbles.html#cb12-2" tabindex="-1"></a>  <span class="fu">filter</span>(ATC2 <span class="sc">==</span> <span class="st">&quot;A10&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb12-3"><a href="tsibbles.html#cb12-3" tabindex="-1"></a>  <span class="fu">select</span>(Month, Concession, Type, Cost) <span class="sc">|&gt;</span></span>
<span id="cb12-4"><a href="tsibbles.html#cb12-4" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TotalC =</span> <span class="fu">sum</span>(Cost)) <span class="sc">|&gt;</span></span>
<span id="cb12-5"><a href="tsibbles.html#cb12-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Cost =</span> TotalC<span class="sc">/</span><span class="fl">1e6</span>)</span>
<span id="cb12-6"><a href="tsibbles.html#cb12-6" tabindex="-1"></a><span class="co">#&gt; # A tsibble: 204 x 3 [1M]</span></span>
<span id="cb12-7"><a href="tsibbles.html#cb12-7" tabindex="-1"></a><span class="co">#&gt;       Month  TotalC  Cost</span></span>
<span id="cb12-8"><a href="tsibbles.html#cb12-8" tabindex="-1"></a><span class="co">#&gt;       &lt;mth&gt;   &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb12-9"><a href="tsibbles.html#cb12-9" tabindex="-1"></a><span class="co">#&gt;  1 1991 Jul 3526591  3.53</span></span>
<span id="cb12-10"><a href="tsibbles.html#cb12-10" tabindex="-1"></a><span class="co">#&gt;  2 1991 Aug 3180891  3.18</span></span>
<span id="cb12-11"><a href="tsibbles.html#cb12-11" tabindex="-1"></a><span class="co">#&gt;  3 1991 Sep 3252221  3.25</span></span>
<span id="cb12-12"><a href="tsibbles.html#cb12-12" tabindex="-1"></a><span class="co">#&gt;  4 1991 Oct 3611003  3.61</span></span>
<span id="cb12-13"><a href="tsibbles.html#cb12-13" tabindex="-1"></a><span class="co">#&gt;  5 1991 Nov 3565869  3.57</span></span>
<span id="cb12-14"><a href="tsibbles.html#cb12-14" tabindex="-1"></a><span class="co">#&gt;  6 1991 Dec 4306371  4.31</span></span>
<span id="cb12-15"><a href="tsibbles.html#cb12-15" tabindex="-1"></a><span class="co">#&gt;  7 1992 Jan 5088335  5.09</span></span>
<span id="cb12-16"><a href="tsibbles.html#cb12-16" tabindex="-1"></a><span class="co">#&gt;  8 1992 Feb 2814520  2.81</span></span>
<span id="cb12-17"><a href="tsibbles.html#cb12-17" tabindex="-1"></a><span class="co">#&gt;  9 1992 Mar 2985811  2.99</span></span>
<span id="cb12-18"><a href="tsibbles.html#cb12-18" tabindex="-1"></a><span class="co">#&gt; 10 1992 Apr 3204780  3.20</span></span>
<span id="cb12-19"><a href="tsibbles.html#cb12-19" tabindex="-1"></a><span class="co">#&gt; # ℹ 194 more rows</span></span></code></pre></div>
<p>Finally, we will save the resulting tsibble for examples later in this chapter.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="tsibbles.html#cb13-1" tabindex="-1"></a>PBS <span class="sc">|&gt;</span></span>
<span id="cb13-2"><a href="tsibbles.html#cb13-2" tabindex="-1"></a>  <span class="fu">filter</span>(ATC2 <span class="sc">==</span> <span class="st">&quot;A10&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb13-3"><a href="tsibbles.html#cb13-3" tabindex="-1"></a>  <span class="fu">select</span>(Month, Concession, Type, Cost) <span class="sc">|&gt;</span></span>
<span id="cb13-4"><a href="tsibbles.html#cb13-4" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TotalC =</span> <span class="fu">sum</span>(Cost)) <span class="sc">|&gt;</span></span>
<span id="cb13-5"><a href="tsibbles.html#cb13-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Cost =</span> TotalC <span class="sc">/</span> <span class="fl">1e6</span>) <span class="ot">-&gt;</span> a10</span></code></pre></div>
<p>At the end of this series of piped functions, we have used a right assignment (<code>-&gt;</code>), which is not common in R code, but is convenient at the end of a long series of commands as it continues the flow of the code.</p>
</div>
<div id="read-a-csv-file-and-convert-to-a-tsibble" class="section level3 unnumbered hasAnchor">
<h3>Read a csv file and convert to a tsibble<a href="tsibbles.html#read-a-csv-file-and-convert-to-a-tsibble" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Almost all of the data used in this book is already stored as <code>tsibble</code> objects. But most data lives in databases, MS-Excel files or csv files, before it is imported into R. So often the first step in creating a tsibble is to read in the data, and then identify the index and key variables.</p>
<p>For example, suppose we have the following quarterly data stored in a csv file (only the first 10 rows are shown). This data set provides information on the size of the prison population in Australia, disaggregated by state, gender, legal status and indigenous status. (Here, ATSI stands for Aboriginal or Torres Strait Islander.)</p>
<table>
<thead>
<tr class="header">
<th align="left">Date</th>
<th align="left">State</th>
<th align="left">Gender</th>
<th align="left">Legal</th>
<th align="left">Indigenous</th>
<th align="right">Count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">2005-03-01</td>
<td align="left">ACT</td>
<td align="left">Female</td>
<td align="left">Remanded</td>
<td align="left">ATSI</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">2005-03-01</td>
<td align="left">ACT</td>
<td align="left">Female</td>
<td align="left">Remanded</td>
<td align="left">Non-ATSI</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">2005-03-01</td>
<td align="left">ACT</td>
<td align="left">Female</td>
<td align="left">Sentenced</td>
<td align="left">ATSI</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">2005-03-01</td>
<td align="left">ACT</td>
<td align="left">Female</td>
<td align="left">Sentenced</td>
<td align="left">Non-ATSI</td>
<td align="right">5</td>
</tr>
<tr class="odd">
<td align="left">2005-03-01</td>
<td align="left">ACT</td>
<td align="left">Male</td>
<td align="left">Remanded</td>
<td align="left">ATSI</td>
<td align="right">7</td>
</tr>
<tr class="even">
<td align="left">2005-03-01</td>
<td align="left">ACT</td>
<td align="left">Male</td>
<td align="left">Remanded</td>
<td align="left">Non-ATSI</td>
<td align="right">58</td>
</tr>
<tr class="odd">
<td align="left">2005-03-01</td>
<td align="left">ACT</td>
<td align="left">Male</td>
<td align="left">Sentenced</td>
<td align="left">ATSI</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="left">2005-03-01</td>
<td align="left">ACT</td>
<td align="left">Male</td>
<td align="left">Sentenced</td>
<td align="left">Non-ATSI</td>
<td align="right">101</td>
</tr>
<tr class="odd">
<td align="left">2005-03-01</td>
<td align="left">NSW</td>
<td align="left">Female</td>
<td align="left">Remanded</td>
<td align="left">ATSI</td>
<td align="right">51</td>
</tr>
<tr class="even">
<td align="left">2005-03-01</td>
<td align="left">NSW</td>
<td align="left">Female</td>
<td align="left">Remanded</td>
<td align="left">Non-ATSI</td>
<td align="right">131</td>
</tr>
</tbody>
</table>
<p>We can read it into R, and create a tsibble object, by simply identifying which column contains the time index, and which columns are keys. The remaining columns are values — there can be many value columns, although in this case there is only one (<code>Count</code>). The original csv file stored the dates as individual days, although the data is actually quarterly, so we need to convert the <code>Date</code> variable to quarters.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="tsibbles.html#cb14-1" tabindex="-1"></a>prison <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">&quot;https://OTexts.com/fpp3/extrafiles/prison_population.csv&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="tsibbles.html#cb15-1" tabindex="-1"></a>prison <span class="ot">&lt;-</span> prison <span class="sc">|&gt;</span></span>
<span id="cb15-2"><a href="tsibbles.html#cb15-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Quarter =</span> <span class="fu">yearquarter</span>(Date)) <span class="sc">|&gt;</span></span>
<span id="cb15-3"><a href="tsibbles.html#cb15-3" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Date) <span class="sc">|&gt;</span></span>
<span id="cb15-4"><a href="tsibbles.html#cb15-4" tabindex="-1"></a>  <span class="fu">as_tsibble</span>(<span class="at">key =</span> <span class="fu">c</span>(State, Gender, Legal, Indigenous),</span>
<span id="cb15-5"><a href="tsibbles.html#cb15-5" tabindex="-1"></a>             <span class="at">index =</span> Quarter)</span>
<span id="cb15-6"><a href="tsibbles.html#cb15-6" tabindex="-1"></a></span>
<span id="cb15-7"><a href="tsibbles.html#cb15-7" tabindex="-1"></a>prison</span>
<span id="cb15-8"><a href="tsibbles.html#cb15-8" tabindex="-1"></a><span class="co">#&gt; # A tsibble: 3,072 x 6 [1Q]</span></span>
<span id="cb15-9"><a href="tsibbles.html#cb15-9" tabindex="-1"></a><span class="co">#&gt; # Key:       State, Gender, Legal, Indigenous [64]</span></span>
<span id="cb15-10"><a href="tsibbles.html#cb15-10" tabindex="-1"></a><span class="co">#&gt;    State Gender Legal    Indigenous Count Quarter</span></span>
<span id="cb15-11"><a href="tsibbles.html#cb15-11" tabindex="-1"></a><span class="co">#&gt;    &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt;      &lt;dbl&gt;   &lt;qtr&gt;</span></span>
<span id="cb15-12"><a href="tsibbles.html#cb15-12" tabindex="-1"></a><span class="co">#&gt;  1 ACT   Female Remanded ATSI           0 2005 Q1</span></span>
<span id="cb15-13"><a href="tsibbles.html#cb15-13" tabindex="-1"></a><span class="co">#&gt;  2 ACT   Female Remanded ATSI           1 2005 Q2</span></span>
<span id="cb15-14"><a href="tsibbles.html#cb15-14" tabindex="-1"></a><span class="co">#&gt;  3 ACT   Female Remanded ATSI           0 2005 Q3</span></span>
<span id="cb15-15"><a href="tsibbles.html#cb15-15" tabindex="-1"></a><span class="co">#&gt;  4 ACT   Female Remanded ATSI           0 2005 Q4</span></span>
<span id="cb15-16"><a href="tsibbles.html#cb15-16" tabindex="-1"></a><span class="co">#&gt;  5 ACT   Female Remanded ATSI           1 2006 Q1</span></span>
<span id="cb15-17"><a href="tsibbles.html#cb15-17" tabindex="-1"></a><span class="co">#&gt;  6 ACT   Female Remanded ATSI           1 2006 Q2</span></span>
<span id="cb15-18"><a href="tsibbles.html#cb15-18" tabindex="-1"></a><span class="co">#&gt;  7 ACT   Female Remanded ATSI           1 2006 Q3</span></span>
<span id="cb15-19"><a href="tsibbles.html#cb15-19" tabindex="-1"></a><span class="co">#&gt;  8 ACT   Female Remanded ATSI           0 2006 Q4</span></span>
<span id="cb15-20"><a href="tsibbles.html#cb15-20" tabindex="-1"></a><span class="co">#&gt;  9 ACT   Female Remanded ATSI           0 2007 Q1</span></span>
<span id="cb15-21"><a href="tsibbles.html#cb15-21" tabindex="-1"></a><span class="co">#&gt; 10 ACT   Female Remanded ATSI           1 2007 Q2</span></span>
<span id="cb15-22"><a href="tsibbles.html#cb15-22" tabindex="-1"></a><span class="co">#&gt; # ℹ 3,062 more rows</span></span></code></pre></div>
<p>This tsibble contains 64 separate time series corresponding to the combinations of the 8 states, 2 genders, 2 legal statuses and 2 indigenous statuses. Each of these series is 48 observations in length, from 2005 Q1 to 2016 Q4.</p>
<p>For a tsibble to be valid, it requires a unique index for each combination of keys. The <code>tsibble()</code> or <code>as_tsibble()</code> function will return an error if this is not true.</p>
</div>
<div id="the-seasonal-period" class="section level3 unnumbered hasAnchor">
<h3>The seasonal period<a href="tsibbles.html#the-seasonal-period" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<!-- TODO: Also detail problematic periods (months in daily data). -->
<p>Some graphics and some models will use the seasonal period of the data. The seasonal period is the number of observations before the seasonal pattern repeats. In most cases, this will be automatically detected using the time index variable.</p>
<p>Some common periods for different time intervals are shown in the table below:</p>
<table>
<thead>
<tr class="header">
<th align="left">Data</th>
<th align="left">Minute</th>
<th align="left">Hour</th>
<th align="left">Day</th>
<th align="left">Week</th>
<th align="left">Year</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Quarters</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">4</td>
</tr>
<tr class="even">
<td align="left">Months</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">12</td>
</tr>
<tr class="odd">
<td align="left">Weeks</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">52</td>
</tr>
<tr class="even">
<td align="left">Days</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">7</td>
<td align="left">365.25</td>
</tr>
<tr class="odd">
<td align="left">Hours</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">24</td>
<td align="left">168</td>
<td align="left">8766</td>
</tr>
<tr class="even">
<td align="left">Minutes</td>
<td align="left"></td>
<td align="left">60</td>
<td align="left">1440</td>
<td align="left">10080</td>
<td align="left">525960</td>
</tr>
<tr class="odd">
<td align="left">Seconds</td>
<td align="left">60</td>
<td align="left">3600</td>
<td align="left">86400</td>
<td align="left">604800</td>
<td align="left">31557600</td>
</tr>
</tbody>
</table>
<p>For quarterly, monthly and weekly data, there is only one seasonal period — the number of observations within each year. Actually, there are not <span class="math inline">\(52\)</span> weeks in a year, but <span class="math inline">\(365.25/7 = 52.18\)</span> on average, allowing for a leap year every fourth year. Approximating seasonal periods to integers can be useful as many seasonal terms in models only support integer seasonal periods.</p>
<p>If the data is observed more than once per week, then there is often more than one seasonal pattern in the data. For example, data with daily observations might have weekly (period<span class="math inline">\(=7\)</span>) or annual (period<span class="math inline">\(=365.25\)</span>) seasonal patterns. Similarly, data that are observed every minute might have hourly (period<span class="math inline">\(=60\)</span>), daily (period<span class="math inline">\(=24\times60=1440\)</span>), weekly (period<span class="math inline">\(=24\times60\times7=10080\)</span>) and annual seasonality (period<span class="math inline">\(=24\times60\times365.25=525960\)</span>).</p>
<p>More complicated (and unusual) seasonal patterns can be specified using the <code>period()</code> function in the <code>lubridate</code> package.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="graphics.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="time-plots.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
