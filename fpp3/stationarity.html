<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>9.1 Stationarity and differencing | Forecasting: Principles and Practice (3rd ed)</title>
  <meta name="description" content="3rd edition" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="9.1 Stationarity and differencing | Forecasting: Principles and Practice (3rd ed)" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://Otexts.com/fpp3///figs/fpp3_front_cover.jpg" />
  <meta property="og:description" content="3rd edition" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9.1 Stationarity and differencing | Forecasting: Principles and Practice (3rd ed)" />
  <meta name="twitter:site" content="@robjhyndman" />
  <meta name="twitter:description" content="3rd edition" />
  <meta name="twitter:image" content="https://Otexts.com/fpp3///figs/fpp3_front_cover.jpg" />




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="arima.html"/>
<link rel="next" href="backshift.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { 
    equationNumbers: { autoNumber: "AMS" } ,
    Macros: {
      bm: ["\\boldsymbol{#1}",1],
      y:    ["y_{\\text{#1},#2}",2],
      yhat: ["\\hat{y}_{\\text{#1},#2}",2],
      ytilde: ["\\tilde{y}_{\\text{#1},#2}",2],
      Shat: ["\\hat{S}_{\\text{#1},#2}^{(#3)}",3]
    }
  }
});
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-27933797-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-27933797-2');
  gtag('config', 'G-JKBLG3XQGY');
</script>
<link href="https://fonts.googleapis.com/css?family=Fira+Sans|Merriweather" rel="stylesheet">
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hack-font@3/build/web/hack-subset.css">
<script>
  /*
   * Light YouTube Embeds by @labnol
   * Credit: https://www.labnol.org/
   */

  function labnolIframe(div) {
    var iframe = document.createElement('iframe');
    iframe.setAttribute('src', 'https://www.youtube.com/embed/' + div.dataset.id + '?autoplay=1');
    iframe.setAttribute('frameborder', '0');
    iframe.setAttribute('allowfullscreen', '1');
    iframe.setAttribute('allow', 'accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture');
    div.parentNode.replaceChild(iframe, div);
  }

  function initYouTubeVideos() {
    var playerElements = document.querySelectorAll('.youtube-player');
    for (var n = 0; n < playerElements.length; n++) {
      var videoId = playerElements[n].dataset.id;
      var div = document.createElement('div');
      div.setAttribute('data-id', videoId);
      var thumbNode = document.createElement('img');
      thumbNode.src = '//i.ytimg.com/vi/ID/hqdefault.jpg'.replace('ID', videoId);
      div.appendChild(thumbNode);
      var playButton = document.createElement('div');
      playButton.setAttribute('class', 'play');
      div.appendChild(playButton);
      div.onclick = function () {
        labnolIframe(this);
      };
      playerElements[n].appendChild(div);
    }
  }

  document.addEventListener('DOMContentLoaded', initYouTubeVideos);
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Forecasting: Principles and Practice</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Getting started</a>
<ul>
<li class="chapter" data-level="1.1" data-path="what-can-be-forecast.html"><a href="what-can-be-forecast.html"><i class="fa fa-check"></i><b>1.1</b> What can be forecast?</a></li>
<li class="chapter" data-level="1.2" data-path="planning.html"><a href="planning.html"><i class="fa fa-check"></i><b>1.2</b> Forecasting, goals and planning</a></li>
<li class="chapter" data-level="1.3" data-path="determining-what-to-forecast.html"><a href="determining-what-to-forecast.html"><i class="fa fa-check"></i><b>1.3</b> Determining what to forecast</a></li>
<li class="chapter" data-level="1.4" data-path="data-methods.html"><a href="data-methods.html"><i class="fa fa-check"></i><b>1.4</b> Forecasting data and methods</a></li>
<li class="chapter" data-level="1.5" data-path="case-studies.html"><a href="case-studies.html"><i class="fa fa-check"></i><b>1.5</b> Some case studies</a></li>
<li class="chapter" data-level="1.6" data-path="basic-steps.html"><a href="basic-steps.html"><i class="fa fa-check"></i><b>1.6</b> The basic steps in a forecasting task</a></li>
<li class="chapter" data-level="1.7" data-path="perspective.html"><a href="perspective.html"><i class="fa fa-check"></i><b>1.7</b> The statistical forecasting perspective</a></li>
<li class="chapter" data-level="1.8" data-path="intro-exercises.html"><a href="intro-exercises.html"><i class="fa fa-check"></i><b>1.8</b> Exercises</a></li>
<li class="chapter" data-level="1.9" data-path="intro-reading.html"><a href="intro-reading.html"><i class="fa fa-check"></i><b>1.9</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="graphics.html"><a href="graphics.html"><i class="fa fa-check"></i><b>2</b> Time series graphics</a>
<ul>
<li class="chapter" data-level="2.1" data-path="tsibbles.html"><a href="tsibbles.html"><i class="fa fa-check"></i><b>2.1</b> <code>tsibble</code> objects</a></li>
<li class="chapter" data-level="2.2" data-path="time-plots.html"><a href="time-plots.html"><i class="fa fa-check"></i><b>2.2</b> Time plots</a></li>
<li class="chapter" data-level="2.3" data-path="tspatterns.html"><a href="tspatterns.html"><i class="fa fa-check"></i><b>2.3</b> Time series patterns</a></li>
<li class="chapter" data-level="2.4" data-path="seasonal-plots.html"><a href="seasonal-plots.html"><i class="fa fa-check"></i><b>2.4</b> Seasonal plots</a></li>
<li class="chapter" data-level="2.5" data-path="subseries.html"><a href="subseries.html"><i class="fa fa-check"></i><b>2.5</b> Seasonal subseries plots</a></li>
<li class="chapter" data-level="2.6" data-path="scatterplots.html"><a href="scatterplots.html"><i class="fa fa-check"></i><b>2.6</b> Scatterplots</a></li>
<li class="chapter" data-level="2.7" data-path="lag-plots.html"><a href="lag-plots.html"><i class="fa fa-check"></i><b>2.7</b> Lag plots</a></li>
<li class="chapter" data-level="2.8" data-path="acf.html"><a href="acf.html"><i class="fa fa-check"></i><b>2.8</b> Autocorrelation</a></li>
<li class="chapter" data-level="2.9" data-path="wn.html"><a href="wn.html"><i class="fa fa-check"></i><b>2.9</b> White noise</a></li>
<li class="chapter" data-level="2.10" data-path="graphics-exercises.html"><a href="graphics-exercises.html"><i class="fa fa-check"></i><b>2.10</b> Exercises</a></li>
<li class="chapter" data-level="2.11" data-path="graphics-reading.html"><a href="graphics-reading.html"><i class="fa fa-check"></i><b>2.11</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="decomposition.html"><a href="decomposition.html"><i class="fa fa-check"></i><b>3</b> Time series decomposition</a>
<ul>
<li class="chapter" data-level="3.1" data-path="transformations.html"><a href="transformations.html"><i class="fa fa-check"></i><b>3.1</b> Transformations and adjustments</a></li>
<li class="chapter" data-level="3.2" data-path="components.html"><a href="components.html"><i class="fa fa-check"></i><b>3.2</b> Time series components</a></li>
<li class="chapter" data-level="3.3" data-path="moving-averages.html"><a href="moving-averages.html"><i class="fa fa-check"></i><b>3.3</b> Moving averages</a></li>
<li class="chapter" data-level="3.4" data-path="classical-decomposition.html"><a href="classical-decomposition.html"><i class="fa fa-check"></i><b>3.4</b> Classical decomposition</a></li>
<li class="chapter" data-level="3.5" data-path="methods-used-by-official-statistics-agencies.html"><a href="methods-used-by-official-statistics-agencies.html"><i class="fa fa-check"></i><b>3.5</b> Methods used by official statistics agencies</a></li>
<li class="chapter" data-level="3.6" data-path="stl.html"><a href="stl.html"><i class="fa fa-check"></i><b>3.6</b> STL decomposition</a></li>
<li class="chapter" data-level="3.7" data-path="decomposition-exercises.html"><a href="decomposition-exercises.html"><i class="fa fa-check"></i><b>3.7</b> Exercises</a></li>
<li class="chapter" data-level="3.8" data-path="decomposition-reading.html"><a href="decomposition-reading.html"><i class="fa fa-check"></i><b>3.8</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="features.html"><a href="features.html"><i class="fa fa-check"></i><b>4</b> Time series features</a>
<ul>
<li class="chapter" data-level="4.1" data-path="some-simple-statistics.html"><a href="some-simple-statistics.html"><i class="fa fa-check"></i><b>4.1</b> Some simple statistics</a></li>
<li class="chapter" data-level="4.2" data-path="acf-features.html"><a href="acf-features.html"><i class="fa fa-check"></i><b>4.2</b> ACF features</a></li>
<li class="chapter" data-level="4.3" data-path="stlfeatures.html"><a href="stlfeatures.html"><i class="fa fa-check"></i><b>4.3</b> STL Features</a></li>
<li class="chapter" data-level="4.4" data-path="other-features.html"><a href="other-features.html"><i class="fa fa-check"></i><b>4.4</b> Other features</a></li>
<li class="chapter" data-level="4.5" data-path="exploring-australian-tourism-data.html"><a href="exploring-australian-tourism-data.html"><i class="fa fa-check"></i><b>4.5</b> Exploring Australian tourism data</a></li>
<li class="chapter" data-level="4.6" data-path="feast-exercises.html"><a href="feast-exercises.html"><i class="fa fa-check"></i><b>4.6</b> Exercises</a></li>
<li class="chapter" data-level="4.7" data-path="further-reading.html"><a href="further-reading.html"><i class="fa fa-check"></i><b>4.7</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="toolbox.html"><a href="toolbox.html"><i class="fa fa-check"></i><b>5</b> The forecaster’s toolbox</a>
<ul>
<li class="chapter" data-level="5.1" data-path="a-tidy-forecasting-workflow.html"><a href="a-tidy-forecasting-workflow.html"><i class="fa fa-check"></i><b>5.1</b> A tidy forecasting workflow</a></li>
<li class="chapter" data-level="5.2" data-path="simple-methods.html"><a href="simple-methods.html"><i class="fa fa-check"></i><b>5.2</b> Some simple forecasting methods</a></li>
<li class="chapter" data-level="5.3" data-path="residuals.html"><a href="residuals.html"><i class="fa fa-check"></i><b>5.3</b> Fitted values and residuals</a></li>
<li class="chapter" data-level="5.4" data-path="diagnostics.html"><a href="diagnostics.html"><i class="fa fa-check"></i><b>5.4</b> Residual diagnostics</a></li>
<li class="chapter" data-level="5.5" data-path="prediction-intervals.html"><a href="prediction-intervals.html"><i class="fa fa-check"></i><b>5.5</b> Distributional forecasts and prediction intervals</a></li>
<li class="chapter" data-level="5.6" data-path="ftransformations.html"><a href="ftransformations.html"><i class="fa fa-check"></i><b>5.6</b> Forecasting using transformations</a></li>
<li class="chapter" data-level="5.7" data-path="forecasting-decomposition.html"><a href="forecasting-decomposition.html"><i class="fa fa-check"></i><b>5.7</b> Forecasting with decomposition</a></li>
<li class="chapter" data-level="5.8" data-path="accuracy.html"><a href="accuracy.html"><i class="fa fa-check"></i><b>5.8</b> Evaluating point forecast accuracy</a></li>
<li class="chapter" data-level="5.9" data-path="distaccuracy.html"><a href="distaccuracy.html"><i class="fa fa-check"></i><b>5.9</b> Evaluating distributional forecast accuracy</a></li>
<li class="chapter" data-level="5.10" data-path="tscv.html"><a href="tscv.html"><i class="fa fa-check"></i><b>5.10</b> Time series cross-validation</a></li>
<li class="chapter" data-level="5.11" data-path="toolbox-exercises.html"><a href="toolbox-exercises.html"><i class="fa fa-check"></i><b>5.11</b> Exercises</a></li>
<li class="chapter" data-level="5.12" data-path="basics-reading.html"><a href="basics-reading.html"><i class="fa fa-check"></i><b>5.12</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="judgmental.html"><a href="judgmental.html"><i class="fa fa-check"></i><b>6</b> Judgmental forecasts</a>
<ul>
<li class="chapter" data-level="6.1" data-path="judgmental-limitations.html"><a href="judgmental-limitations.html"><i class="fa fa-check"></i><b>6.1</b> Beware of limitations</a></li>
<li class="chapter" data-level="6.2" data-path="judgmental-principles.html"><a href="judgmental-principles.html"><i class="fa fa-check"></i><b>6.2</b> Key principles</a></li>
<li class="chapter" data-level="6.3" data-path="delphimethod.html"><a href="delphimethod.html"><i class="fa fa-check"></i><b>6.3</b> The Delphi method</a></li>
<li class="chapter" data-level="6.4" data-path="analogies.html"><a href="analogies.html"><i class="fa fa-check"></i><b>6.4</b> Forecasting by analogy</a></li>
<li class="chapter" data-level="6.5" data-path="scenarios.html"><a href="scenarios.html"><i class="fa fa-check"></i><b>6.5</b> Scenario forecasting</a></li>
<li class="chapter" data-level="6.6" data-path="new-products.html"><a href="new-products.html"><i class="fa fa-check"></i><b>6.6</b> New product forecasting</a></li>
<li class="chapter" data-level="6.7" data-path="judgmental-adjustments.html"><a href="judgmental-adjustments.html"><i class="fa fa-check"></i><b>6.7</b> Judgmental adjustments</a></li>
<li class="chapter" data-level="6.8" data-path="judgmental-reading.html"><a href="judgmental-reading.html"><i class="fa fa-check"></i><b>6.8</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>7</b> Time series regression models</a>
<ul>
<li class="chapter" data-level="7.1" data-path="regression-intro.html"><a href="regression-intro.html"><i class="fa fa-check"></i><b>7.1</b> The linear model</a></li>
<li class="chapter" data-level="7.2" data-path="least-squares.html"><a href="least-squares.html"><i class="fa fa-check"></i><b>7.2</b> Least squares estimation</a></li>
<li class="chapter" data-level="7.3" data-path="regression-evaluation.html"><a href="regression-evaluation.html"><i class="fa fa-check"></i><b>7.3</b> Evaluating the regression model</a></li>
<li class="chapter" data-level="7.4" data-path="useful-predictors.html"><a href="useful-predictors.html"><i class="fa fa-check"></i><b>7.4</b> Some useful predictors</a></li>
<li class="chapter" data-level="7.5" data-path="selecting-predictors.html"><a href="selecting-predictors.html"><i class="fa fa-check"></i><b>7.5</b> Selecting predictors</a></li>
<li class="chapter" data-level="7.6" data-path="forecasting-regression.html"><a href="forecasting-regression.html"><i class="fa fa-check"></i><b>7.6</b> Forecasting with regression</a></li>
<li class="chapter" data-level="7.7" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html"><i class="fa fa-check"></i><b>7.7</b> Nonlinear regression</a></li>
<li class="chapter" data-level="7.8" data-path="causality.html"><a href="causality.html"><i class="fa fa-check"></i><b>7.8</b> Correlation, causation and forecasting</a></li>
<li class="chapter" data-level="7.9" data-path="regression-matrices.html"><a href="regression-matrices.html"><i class="fa fa-check"></i><b>7.9</b> Matrix formulation</a></li>
<li class="chapter" data-level="7.10" data-path="regression-exercises.html"><a href="regression-exercises.html"><i class="fa fa-check"></i><b>7.10</b> Exercises</a></li>
<li class="chapter" data-level="7.11" data-path="regression-reading.html"><a href="regression-reading.html"><i class="fa fa-check"></i><b>7.11</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="expsmooth.html"><a href="expsmooth.html"><i class="fa fa-check"></i><b>8</b> Exponential smoothing</a>
<ul>
<li class="chapter" data-level="8.1" data-path="ses.html"><a href="ses.html"><i class="fa fa-check"></i><b>8.1</b> Simple exponential smoothing</a></li>
<li class="chapter" data-level="8.2" data-path="holt.html"><a href="holt.html"><i class="fa fa-check"></i><b>8.2</b> Methods with trend</a></li>
<li class="chapter" data-level="8.3" data-path="holt-winters.html"><a href="holt-winters.html"><i class="fa fa-check"></i><b>8.3</b> Methods with seasonality</a></li>
<li class="chapter" data-level="8.4" data-path="taxonomy.html"><a href="taxonomy.html"><i class="fa fa-check"></i><b>8.4</b> A taxonomy of exponential smoothing methods</a></li>
<li class="chapter" data-level="8.5" data-path="ets.html"><a href="ets.html"><i class="fa fa-check"></i><b>8.5</b> Innovations state space models for exponential smoothing</a></li>
<li class="chapter" data-level="8.6" data-path="ets-estimation.html"><a href="ets-estimation.html"><i class="fa fa-check"></i><b>8.6</b> Estimation and model selection</a></li>
<li class="chapter" data-level="8.7" data-path="ets-forecasting.html"><a href="ets-forecasting.html"><i class="fa fa-check"></i><b>8.7</b> Forecasting with ETS models</a></li>
<li class="chapter" data-level="8.8" data-path="expsmooth-exercises.html"><a href="expsmooth-exercises.html"><i class="fa fa-check"></i><b>8.8</b> Exercises</a></li>
<li class="chapter" data-level="8.9" data-path="expsmooth-reading.html"><a href="expsmooth-reading.html"><i class="fa fa-check"></i><b>8.9</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="arima.html"><a href="arima.html"><i class="fa fa-check"></i><b>9</b> ARIMA models</a>
<ul>
<li class="chapter" data-level="9.1" data-path="stationarity.html"><a href="stationarity.html"><i class="fa fa-check"></i><b>9.1</b> Stationarity and differencing</a></li>
<li class="chapter" data-level="9.2" data-path="backshift.html"><a href="backshift.html"><i class="fa fa-check"></i><b>9.2</b> Backshift notation</a></li>
<li class="chapter" data-level="9.3" data-path="AR.html"><a href="AR.html"><i class="fa fa-check"></i><b>9.3</b> Autoregressive models</a></li>
<li class="chapter" data-level="9.4" data-path="MA.html"><a href="MA.html"><i class="fa fa-check"></i><b>9.4</b> Moving average models</a></li>
<li class="chapter" data-level="9.5" data-path="non-seasonal-arima.html"><a href="non-seasonal-arima.html"><i class="fa fa-check"></i><b>9.5</b> Non-seasonal ARIMA models</a></li>
<li class="chapter" data-level="9.6" data-path="arima-estimation.html"><a href="arima-estimation.html"><i class="fa fa-check"></i><b>9.6</b> Estimation and order selection</a></li>
<li class="chapter" data-level="9.7" data-path="arima-r.html"><a href="arima-r.html"><i class="fa fa-check"></i><b>9.7</b> ARIMA modelling in <code>fable</code></a></li>
<li class="chapter" data-level="9.8" data-path="arima-forecasting.html"><a href="arima-forecasting.html"><i class="fa fa-check"></i><b>9.8</b> Forecasting</a></li>
<li class="chapter" data-level="9.9" data-path="seasonal-arima.html"><a href="seasonal-arima.html"><i class="fa fa-check"></i><b>9.9</b> Seasonal ARIMA models</a></li>
<li class="chapter" data-level="9.10" data-path="arima-ets.html"><a href="arima-ets.html"><i class="fa fa-check"></i><b>9.10</b> ARIMA vs ETS</a></li>
<li class="chapter" data-level="9.11" data-path="arima-exercises.html"><a href="arima-exercises.html"><i class="fa fa-check"></i><b>9.11</b> Exercises</a></li>
<li class="chapter" data-level="9.12" data-path="arima-reading.html"><a href="arima-reading.html"><i class="fa fa-check"></i><b>9.12</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="dynamic.html"><a href="dynamic.html"><i class="fa fa-check"></i><b>10</b> Dynamic regression models</a>
<ul>
<li class="chapter" data-level="10.1" data-path="estimation.html"><a href="estimation.html"><i class="fa fa-check"></i><b>10.1</b> Estimation</a></li>
<li class="chapter" data-level="10.2" data-path="regarima.html"><a href="regarima.html"><i class="fa fa-check"></i><b>10.2</b> Regression with ARIMA errors using <code>fable</code></a></li>
<li class="chapter" data-level="10.3" data-path="forecasting.html"><a href="forecasting.html"><i class="fa fa-check"></i><b>10.3</b> Forecasting</a></li>
<li class="chapter" data-level="10.4" data-path="stochastic-and-deterministic-trends.html"><a href="stochastic-and-deterministic-trends.html"><i class="fa fa-check"></i><b>10.4</b> Stochastic and deterministic trends</a></li>
<li class="chapter" data-level="10.5" data-path="dhr.html"><a href="dhr.html"><i class="fa fa-check"></i><b>10.5</b> Dynamic harmonic regression</a></li>
<li class="chapter" data-level="10.6" data-path="lagged-predictors.html"><a href="lagged-predictors.html"><i class="fa fa-check"></i><b>10.6</b> Lagged predictors</a></li>
<li class="chapter" data-level="10.7" data-path="dynamic-exercises.html"><a href="dynamic-exercises.html"><i class="fa fa-check"></i><b>10.7</b> Exercises</a></li>
<li class="chapter" data-level="10.8" data-path="dynamic-reading.html"><a href="dynamic-reading.html"><i class="fa fa-check"></i><b>10.8</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="hierarchical.html"><a href="hierarchical.html"><i class="fa fa-check"></i><b>11</b> Forecasting hierarchical and grouped time series</a>
<ul>
<li class="chapter" data-level="11.1" data-path="hts.html"><a href="hts.html"><i class="fa fa-check"></i><b>11.1</b> Hierarchical and grouped time series</a></li>
<li class="chapter" data-level="11.2" data-path="single-level.html"><a href="single-level.html"><i class="fa fa-check"></i><b>11.2</b> Single level approaches</a></li>
<li class="chapter" data-level="11.3" data-path="reconciliation.html"><a href="reconciliation.html"><i class="fa fa-check"></i><b>11.3</b> Forecast reconciliation</a></li>
<li class="chapter" data-level="11.4" data-path="tourism.html"><a href="tourism.html"><i class="fa fa-check"></i><b>11.4</b> Forecasting Australian domestic tourism</a></li>
<li class="chapter" data-level="11.5" data-path="rec-prob.html"><a href="rec-prob.html"><i class="fa fa-check"></i><b>11.5</b> Reconciled distributional forecasts</a></li>
<li class="chapter" data-level="11.6" data-path="prison.html"><a href="prison.html"><i class="fa fa-check"></i><b>11.6</b> Forecasting Australian prison population</a></li>
<li class="chapter" data-level="11.7" data-path="hierarchical-exercises.html"><a href="hierarchical-exercises.html"><i class="fa fa-check"></i><b>11.7</b> Exercises</a></li>
<li class="chapter" data-level="11.8" data-path="hierarchical-reading.html"><a href="hierarchical-reading.html"><i class="fa fa-check"></i><b>11.8</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="advanced.html"><a href="advanced.html"><i class="fa fa-check"></i><b>12</b> Advanced forecasting methods</a>
<ul>
<li class="chapter" data-level="12.1" data-path="complexseasonality.html"><a href="complexseasonality.html"><i class="fa fa-check"></i><b>12.1</b> Complex seasonality</a></li>
<li class="chapter" data-level="12.2" data-path="prophet.html"><a href="prophet.html"><i class="fa fa-check"></i><b>12.2</b> Prophet model</a></li>
<li class="chapter" data-level="12.3" data-path="VAR.html"><a href="VAR.html"><i class="fa fa-check"></i><b>12.3</b> Vector autoregressions</a></li>
<li class="chapter" data-level="12.4" data-path="nnetar.html"><a href="nnetar.html"><i class="fa fa-check"></i><b>12.4</b> Neural network models</a></li>
<li class="chapter" data-level="12.5" data-path="bootstrap.html"><a href="bootstrap.html"><i class="fa fa-check"></i><b>12.5</b> Bootstrapping and bagging</a></li>
<li class="chapter" data-level="12.6" data-path="advanced-exercises.html"><a href="advanced-exercises.html"><i class="fa fa-check"></i><b>12.6</b> Exercises</a></li>
<li class="chapter" data-level="12.7" data-path="advanced-reading.html"><a href="advanced-reading.html"><i class="fa fa-check"></i><b>12.7</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="practical.html"><a href="practical.html"><i class="fa fa-check"></i><b>13</b> Some practical forecasting issues</a>
<ul>
<li class="chapter" data-level="13.1" data-path="weekly.html"><a href="weekly.html"><i class="fa fa-check"></i><b>13.1</b> Weekly, daily and sub-daily data</a></li>
<li class="chapter" data-level="13.2" data-path="counts.html"><a href="counts.html"><i class="fa fa-check"></i><b>13.2</b> Time series of counts</a></li>
<li class="chapter" data-level="13.3" data-path="limits.html"><a href="limits.html"><i class="fa fa-check"></i><b>13.3</b> Ensuring forecasts stay within limits</a></li>
<li class="chapter" data-level="13.4" data-path="combinations.html"><a href="combinations.html"><i class="fa fa-check"></i><b>13.4</b> Forecast combinations</a></li>
<li class="chapter" data-level="13.5" data-path="aggregates.html"><a href="aggregates.html"><i class="fa fa-check"></i><b>13.5</b> Prediction intervals for aggregates</a></li>
<li class="chapter" data-level="13.6" data-path="backcasting.html"><a href="backcasting.html"><i class="fa fa-check"></i><b>13.6</b> Backcasting</a></li>
<li class="chapter" data-level="13.7" data-path="long-short-ts.html"><a href="long-short-ts.html"><i class="fa fa-check"></i><b>13.7</b> Very long and very short time series</a></li>
<li class="chapter" data-level="13.8" data-path="training-test.html"><a href="training-test.html"><i class="fa fa-check"></i><b>13.8</b> Forecasting on training and test sets</a></li>
<li class="chapter" data-level="13.9" data-path="missing-outliers.html"><a href="missing-outliers.html"><i class="fa fa-check"></i><b>13.9</b> Dealing with outliers and missing values</a></li>
<li class="chapter" data-level="13.10" data-path="further-reading-1.html"><a href="further-reading-1.html"><i class="fa fa-check"></i><b>13.10</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-using-r.html"><a href="appendix-using-r.html"><i class="fa fa-check"></i>Appendix: Using R</a></li>
<li class="chapter" data-level="" data-path="appendix-for-instructors.html"><a href="appendix-for-instructors.html"><i class="fa fa-check"></i>Appendix: For instructors</a></li>
<li class="chapter" data-level="" data-path="appendix-reviews.html"><a href="appendix-reviews.html"><i class="fa fa-check"></i>Appendix: Reviews</a></li>
<li class="chapter" data-level="" data-path="translations.html"><a href="translations.html"><i class="fa fa-check"></i>Translations</a></li>
<li class="chapter" data-level="" data-path="about-the-authors.html"><a href="about-the-authors.html"><i class="fa fa-check"></i>About the authors</a></li>
<li class="chapter" data-level="" data-path="buy-a-print-version.html"><a href="buy-a-print-version.html"><i class="fa fa-check"></i>Buy a print version</a></li>
<li class="chapter" data-level="" data-path="report-an-error.html"><a href="report-an-error.html"><i class="fa fa-check"></i>Report an error</a></li>
<li class="chapter" data-level="" data-path="bibliography.html"><a href="bibliography.html"><i class="fa fa-check"></i>Bibliography</a></li>
<li class="divider"></li>
<li><a href="https://OTexts.com" target="blank">Published by OTexts™ with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Forecasting: Principles and Practice <font size=-1>(3rd ed)</font></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="stationarity" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> Stationarity and differencing<a href="stationarity.html#stationarity" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="youtube-player" data-id="xIzEcEFi9_k">

</div>
<p>A stationary time series is one whose statistical properties do not depend on the time at which the series is observed.<a href="#fn18" class="footnote-ref" id="fnref18"><sup>18</sup></a> Thus, time series with trends, or with seasonality, are not stationary — the trend and seasonality will affect the value of the time series at different times. On the other hand, a white noise series is stationary — it does not matter when you observe it, it should look much the same at any point in time.</p>
<p>Some cases can be confusing — a time series with cyclic behaviour (but with no trend or seasonality) is stationary. This is because the cycles are not of a fixed length, so before we observe the series we cannot be sure where the peaks and troughs of the cycles will be.</p>
<p>In general, a stationary time series will have no predictable patterns in the long-term. Time plots will show the series to be roughly horizontal (although some cyclic behaviour is possible), with constant variance.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:stationary"></span>
<img src="fpp_files/figure-html/stationary-1.png" alt="Which of these series are stationary? (a) Google closing stock price in 2015; (b) Daily change in the Google stock price in 2015; (c) Annual number of strikes in the US; (d) Monthly sales of new one-family houses sold in the US; (e) Annual price of a dozen eggs in the US (constant dollars); (f) Monthly total of pigs slaughtered in Victoria, Australia; (g) Annual total of Canadian Lynx furs traded by the Hudson Bay Company; (h) Quarterly Australian beer production; (i) Monthly Australian gas production." width="100%" />
<p class="caption">
Figure 9.1: Which of these series are stationary? (a) Google closing stock price in 2015; (b) Daily change in the Google stock price in 2015; (c) Annual number of strikes in the US; (d) Monthly sales of new one-family houses sold in the US; (e) Annual price of a dozen eggs in the US (constant dollars); (f) Monthly total of pigs slaughtered in Victoria, Australia; (g) Annual total of Canadian Lynx furs traded by the Hudson Bay Company; (h) Quarterly Australian beer production; (i) Monthly Australian gas production.
</p>
</div>
<p>Consider the nine series plotted in Figure <a href="stationarity.html#fig:stationary">9.1</a>. Which of these do you think are stationary?</p>
<p>Obvious seasonality rules out series (d), (h) and (i). Trends and changing levels rules out series (a), (c), (e), (f) and (i). Increasing variance also rules out (i). That leaves only (b) and (g) as stationary series.</p>
<p>At first glance, the strong cycles in series (g) might appear to make it non-stationary. But these cycles are aperiodic — they are caused when the lynx population becomes too large for the available feed, so that they stop breeding and the population falls to low numbers, then the regeneration of their food sources allows the population to grow again, and so on. In the long-term, the timing of these cycles is not predictable. Hence the series is stationary.</p>
<div id="differencing" class="section level3 unnumbered hasAnchor">
<h3>Differencing<a href="stationarity.html#differencing" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p></p>
<p>In Figure <a href="stationarity.html#fig:stationary">9.1</a>, note that the Google stock price was non-stationary in panel (a), but the daily changes were stationary in panel (b). This shows one way to make a non-stationary time series stationary — compute the differences between consecutive observations. This is known as <strong>differencing</strong>.</p>
<p>Transformations such as logarithms can help to stabilise the variance of a time series. Differencing can help stabilise the mean of a time series by removing changes in the level of a time series, and therefore eliminating (or reducing) trend and seasonality.</p>
<p>As well as the time plot of the data, the ACF plot is also useful for identifying non-stationary time series. For a stationary time series, the ACF will drop to zero relatively quickly, while the ACF of non-stationary data decreases slowly. Also, for non-stationary data, the value of <span class="math inline">\(r_1\)</span> is often large and positive.</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="stationarity.html#cb176-1" tabindex="-1"></a>google_2015 <span class="ot">&lt;-</span> gafa_stock <span class="sc">|&gt;</span></span>
<span id="cb176-2"><a href="stationarity.html#cb176-2" tabindex="-1"></a>  <span class="fu">filter</span>(Symbol <span class="sc">==</span> <span class="st">&quot;GOOG&quot;</span>, <span class="fu">year</span>(Date) <span class="sc">==</span> <span class="dv">2015</span>)</span></code></pre></div>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="stationarity.html#cb177-1" tabindex="-1"></a>google_2015 <span class="sc">|&gt;</span> <span class="fu">ACF</span>(Close) <span class="sc">|&gt;</span></span>
<span id="cb177-2"><a href="stationarity.html#cb177-2" tabindex="-1"></a>  <span class="fu">autoplot</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Google closing stock price&quot;</span>)</span>
<span id="cb177-3"><a href="stationarity.html#cb177-3" tabindex="-1"></a>google_2015 <span class="sc">|&gt;</span> <span class="fu">ACF</span>(<span class="fu">difference</span>(Close)) <span class="sc">|&gt;</span></span>
<span id="cb177-4"><a href="stationarity.html#cb177-4" tabindex="-1"></a>  <span class="fu">autoplot</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Changes in Google closing stock price&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:acfstationary"></span>
<img src="fpp_files/figure-html/acfstationary-1.png" alt="The ACF of the Google closing stock price in 2015 (left) and of the daily changes in Google closing stock price in 2015 (right)." width="100%" />
<p class="caption">
Figure 9.2: The ACF of the Google closing stock price in 2015 (left) and of the daily changes in Google closing stock price in 2015 (right).
</p>
</div>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="stationarity.html#cb178-1" tabindex="-1"></a>google_2015 <span class="sc">|&gt;</span></span>
<span id="cb178-2"><a href="stationarity.html#cb178-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diff_close =</span> <span class="fu">difference</span>(Close)) <span class="sc">|&gt;</span></span>
<span id="cb178-3"><a href="stationarity.html#cb178-3" tabindex="-1"></a>  <span class="fu">features</span>(diff_close, ljung_box, <span class="at">lag =</span> <span class="dv">10</span>)</span>
<span id="cb178-4"><a href="stationarity.html#cb178-4" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1 × 3</span></span>
<span id="cb178-5"><a href="stationarity.html#cb178-5" tabindex="-1"></a><span class="co">#&gt;   Symbol lb_stat lb_pvalue</span></span>
<span id="cb178-6"><a href="stationarity.html#cb178-6" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;    &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span id="cb178-7"><a href="stationarity.html#cb178-7" tabindex="-1"></a><span class="co">#&gt; 1 GOOG      7.91     0.637</span></span></code></pre></div>
<p>The ACF of the differenced Google stock price looks just like that of a white noise series. Only one autocorrelation is outside of the 95% limits, and the Ljung-Box <span class="math inline">\(Q^*\)</span> statistic has a <em>p</em>-value of 0.637 (for <span class="math inline">\(h=10\)</span>). This suggests that the <em>daily change</em> in the Google stock price is essentially a random amount which is uncorrelated with that of previous days.</p>
</div>
<div id="random-walk-model" class="section level3 unnumbered hasAnchor">
<h3>Random walk model<a href="stationarity.html#random-walk-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="youtube-player" data-id="G_20g65lrr8">

</div>
<p>The differenced series is the <em>change</em> between consecutive observations in the original series, and can be written as
<span class="math display">\[
  y&#39;_t = y_t - y_{t-1}.
\]</span>
The differenced series will have only <span class="math inline">\(T-1\)</span> values, since it is not possible to calculate a difference <span class="math inline">\(y_1&#39;\)</span> for the first observation.</p>
<p>When the differenced series is white noise, the model for the original series can be written as
<span class="math display">\[
  y_t - y_{t-1} = \varepsilon_t,
\]</span>
where <span class="math inline">\(\varepsilon_t\)</span> denotes white noise.
Rearranging this leads to the “random walk” model
<span class="math display">\[
  y_t = y_{t-1} + \varepsilon_t.
\]</span>
Random walk models are widely used for non-stationary data, particularly financial and economic data. Random walks typically have:</p>
<ul>
<li>long periods of apparent trends up or down</li>
<li>sudden and unpredictable changes in direction.</li>
</ul>
<p>The forecasts from a random walk model are equal to the last observation, as future movements are unpredictable, and are equally likely to be up or down. Thus, the random walk model underpins naïve forecasts, first introduced in Section <a href="simple-methods.html#simple-methods">5.2</a>.</p>
<p>A closely related model allows the differences to have a non-zero mean. Then
<span class="math display">\[
  y_t - y_{t-1} = c + \varepsilon_t\quad\text{or}\quad {y_t = c + y_{t-1} + \varepsilon_t}\: .
\]</span>
The value of <span class="math inline">\(c\)</span> is the average of the changes between consecutive observations. If <span class="math inline">\(c\)</span> is positive, then the average change is an increase in the value of <span class="math inline">\(y_t\)</span>. Thus, <span class="math inline">\(y_t\)</span> will tend to drift upwards. However, if <span class="math inline">\(c\)</span> is negative, <span class="math inline">\(y_t\)</span> will tend to drift downwards.</p>
<p>This is the model behind the drift method, also discussed in Section <a href="simple-methods.html#simple-methods">5.2</a>.</p>
</div>
<div id="second-order-differencing" class="section level3 unnumbered hasAnchor">
<h3>Second-order differencing<a href="stationarity.html#second-order-differencing" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Occasionally the differenced data will not appear to be stationary and it may be necessary to difference the data a second time to obtain a stationary series:
<span class="math display">\[\begin{align*}
  y&#39;&#39;_{t}  &amp;=  y&#39;_{t}  - y&#39;_{t - 1} \\
           &amp;= (y_t - y_{t-1}) - (y_{t-1}-y_{t-2})\\
           &amp;= y_t - 2y_{t-1} +y_{t-2}.
\end{align*}\]</span>
In this case, <span class="math inline">\(y_t&#39;&#39;\)</span> will have <span class="math inline">\(T-2\)</span> values. Then, we would model the “change in the changes” of the original data. In practice, it is almost never necessary to go beyond second-order differences.</p>
</div>
<div id="seasonal-differencing" class="section level3 unnumbered hasAnchor">
<h3>Seasonal differencing<a href="stationarity.html#seasonal-differencing" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A seasonal difference is the difference between an observation and the previous observation from the same season. So
<span class="math display">\[
  y&#39;_t = y_t - y_{t-m},
\]</span>
where <span class="math inline">\(m=\)</span> the number of seasons. These are also called “lag-<span class="math inline">\(m\)</span> differences”, as we subtract the observation after a lag of <span class="math inline">\(m\)</span> periods.</p>
<p>If seasonally differenced data appear to be white noise, then an appropriate model for the original data is
<span class="math display">\[
  y_t = y_{t-m}+\varepsilon_t.
\]</span>
Forecasts from this model are equal to the last observation from the relevant season. That is, this model gives seasonal naïve forecasts, introduced in Section <a href="simple-methods.html#simple-methods">5.2</a>.</p>
<p>The bottom panel in Figure <a href="stationarity.html#fig:a10diff">9.3</a> shows the seasonal differences of the logarithm of the monthly scripts for A10 (antidiabetic) drugs sold in Australia. The transformation and differencing have made the series look relatively stationary.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:a10diff"></span>
<img src="fpp_files/figure-html/a10diff-1.png" alt="Logs and seasonal differences of the A10 (antidiabetic) sales data. The logarithms stabilise the variance, while the seasonal differences remove the seasonality and trend." width="100%" />
<p class="caption">
Figure 9.3: Logs and seasonal differences of the A10 (antidiabetic) sales data. The logarithms stabilise the variance, while the seasonal differences remove the seasonality and trend.
</p>
</div>
<p>To distinguish seasonal differences from ordinary differences, we sometimes refer to ordinary differences as “first differences”, meaning differences at lag 1.</p>
<p>Sometimes it is necessary to take both a seasonal difference and a first difference to obtain stationary data. Figure <a href="stationarity.html#fig:h02diff">9.4</a> plots Australian corticosteroid drug sales ($AUD) (top panel). Here, the data are first transformed using logarithms (second panel), then seasonal differences are calculated (third panel). The data still seem somewhat non-stationary, and so a further lot of first differences are computed (bottom panel).</p>

<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="stationarity.html#cb179-1" tabindex="-1"></a>PBS <span class="sc">|&gt;</span></span>
<span id="cb179-2"><a href="stationarity.html#cb179-2" tabindex="-1"></a>  <span class="fu">filter</span>(ATC2 <span class="sc">==</span> <span class="st">&quot;H02&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb179-3"><a href="stationarity.html#cb179-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Cost =</span> <span class="fu">sum</span>(Cost)<span class="sc">/</span><span class="fl">1e6</span>) <span class="sc">|&gt;</span></span>
<span id="cb179-4"><a href="stationarity.html#cb179-4" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb179-5"><a href="stationarity.html#cb179-5" tabindex="-1"></a>    <span class="st">`</span><span class="at">Sales ($million)</span><span class="st">`</span> <span class="ot">=</span> Cost,</span>
<span id="cb179-6"><a href="stationarity.html#cb179-6" tabindex="-1"></a>    <span class="st">`</span><span class="at">Log sales</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">log</span>(Cost),</span>
<span id="cb179-7"><a href="stationarity.html#cb179-7" tabindex="-1"></a>    <span class="st">`</span><span class="at">Annual change in log sales</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">difference</span>(<span class="fu">log</span>(Cost), <span class="dv">12</span>),</span>
<span id="cb179-8"><a href="stationarity.html#cb179-8" tabindex="-1"></a>    <span class="st">`</span><span class="at">Doubly differenced log sales</span><span class="st">`</span> <span class="ot">=</span></span>
<span id="cb179-9"><a href="stationarity.html#cb179-9" tabindex="-1"></a>                     <span class="fu">difference</span>(<span class="fu">difference</span>(<span class="fu">log</span>(Cost), <span class="dv">12</span>), <span class="dv">1</span>)</span>
<span id="cb179-10"><a href="stationarity.html#cb179-10" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb179-11"><a href="stationarity.html#cb179-11" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>Month, <span class="at">names_to=</span><span class="st">&quot;Type&quot;</span>, <span class="at">values_to=</span><span class="st">&quot;Sales&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb179-12"><a href="stationarity.html#cb179-12" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb179-13"><a href="stationarity.html#cb179-13" tabindex="-1"></a>    <span class="at">Type =</span> <span class="fu">factor</span>(Type, <span class="at">levels =</span> <span class="fu">c</span>(</span>
<span id="cb179-14"><a href="stationarity.html#cb179-14" tabindex="-1"></a>      <span class="st">&quot;Sales ($million)&quot;</span>,</span>
<span id="cb179-15"><a href="stationarity.html#cb179-15" tabindex="-1"></a>      <span class="st">&quot;Log sales&quot;</span>,</span>
<span id="cb179-16"><a href="stationarity.html#cb179-16" tabindex="-1"></a>      <span class="st">&quot;Annual change in log sales&quot;</span>,</span>
<span id="cb179-17"><a href="stationarity.html#cb179-17" tabindex="-1"></a>      <span class="st">&quot;Doubly differenced log sales&quot;</span>))</span>
<span id="cb179-18"><a href="stationarity.html#cb179-18" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb179-19"><a href="stationarity.html#cb179-19" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Month, <span class="at">y =</span> Sales)) <span class="sc">+</span></span>
<span id="cb179-20"><a href="stationarity.html#cb179-20" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb179-21"><a href="stationarity.html#cb179-21" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="fu">vars</span>(Type), <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb179-22"><a href="stationarity.html#cb179-22" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Corticosteroid drug sales&quot;</span>, <span class="at">y =</span> <span class="cn">NULL</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:h02diff"></span>
<img src="fpp_files/figure-html/h02diff-1.png" alt="Top panel: Corticosteroid drug sales ($AUD). Other panels show the same data after transforming and differencing." width="100%" />
<p class="caption">
Figure 9.4: Top panel: Corticosteroid drug sales ($AUD). Other panels show the same data after transforming and differencing.
</p>
</div>
<p>There is a degree of subjectivity in selecting which differences to apply. The seasonally differenced data in Figure <a href="stationarity.html#fig:a10diff">9.3</a> do not show substantially different behaviour from the seasonally differenced data in Figure <a href="stationarity.html#fig:h02diff">9.4</a>. In the latter case, we could have decided to stop with the seasonally differenced data, and not done an extra round of differencing. In the former case, we could have decided that the data were not sufficiently stationary and taken an extra round of differencing. Some formal tests for differencing are discussed below, but there are always some choices to be made in the modelling process, and different analysts may make different choices.</p>
<p>If <span class="math inline">\(y&#39;_t = y_t - y_{t-m}\)</span> denotes a seasonally differenced series, then the twice-differenced series is
<span class="math display">\[\begin{align*}
y&#39;&#39;_t &amp;= y&#39;_t - y&#39;_{t-1} \\
      &amp;= (y_t - y_{t-m}) - (y_{t-1} - y_{t-m-1}) \\
      &amp;= y_t -y_{t-1} - y_{t-m} + y_{t-m-1}\:
\end{align*}\]</span>
When both seasonal and first differences are applied, it makes no difference which is done first—the result will be the same. However, if the data have a strong seasonal pattern, we recommend that seasonal differencing be done first, because the resulting series will sometimes be stationary and there will be no need for a further first difference. If first differencing is done first, there will still be seasonality present.</p>
<p>Beware that applying more differences than required will induce false dynamics or autocorrelations that do not really exist in the time series. Therefore, do as few differences as necessary to obtain a stationary series.</p>
<p>It is important that if differencing is used, the differences are interpretable. First differences are the change between one observation and the next. Seasonal differences are the change between one year to the next. Other lags are unlikely to make much interpretable sense and should be avoided.</p>
</div>
<div id="unit-root-tests" class="section level3 unnumbered hasAnchor">
<h3>Unit root tests<a href="stationarity.html#unit-root-tests" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="youtube-player" data-id="ZPtVV-a0pks">

</div>
<p>One way to determine more objectively whether differencing is required is to use a <em>unit root test</em>. These are statistical hypothesis tests of stationarity that are designed for determining whether differencing is required.</p>
<p>A number of unit root tests are available, which are based on different assumptions and may lead to conflicting answers. In our analysis, we use the <em>Kwiatkowski-Phillips-Schmidt-Shin (KPSS) test</em> <span class="citation">(<a href="#ref-KPSS92">Kwiatkowski et al., 1992</a>)</span>. In this test, the null hypothesis is that the data are stationary, and we look for evidence that the null hypothesis is false. Consequently, small p-values (e.g., less than 0.05) suggest that differencing is required. The test can be computed using the <code>unitroot_kpss()</code> function.</p>
<p>For example, let us apply it to the Google stock price data.</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="stationarity.html#cb180-1" tabindex="-1"></a>google_2015 <span class="sc">|&gt;</span></span>
<span id="cb180-2"><a href="stationarity.html#cb180-2" tabindex="-1"></a>  <span class="fu">features</span>(Close, unitroot_kpss)</span>
<span id="cb180-3"><a href="stationarity.html#cb180-3" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1 × 3</span></span>
<span id="cb180-4"><a href="stationarity.html#cb180-4" tabindex="-1"></a><span class="co">#&gt;   Symbol kpss_stat kpss_pvalue</span></span>
<span id="cb180-5"><a href="stationarity.html#cb180-5" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;      &lt;dbl&gt;       &lt;dbl&gt;</span></span>
<span id="cb180-6"><a href="stationarity.html#cb180-6" tabindex="-1"></a><span class="co">#&gt; 1 GOOG        3.56        0.01</span></span></code></pre></div>
<p>The KPSS test p-value is reported as a number between 0.01 and 0.1. If the actual p-value is less than 0.01, it is reported as 0.01; and if the actual p-value is greater than 0.1, it is reported as 0.1. In this case, the p-value is shown as 0.01 (and therefore it may be smaller than that), indicating that the null hypothesis is rejected. That is, the data are not stationary. We can difference the data, and apply the test again.</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="stationarity.html#cb181-1" tabindex="-1"></a>google_2015 <span class="sc">|&gt;</span></span>
<span id="cb181-2"><a href="stationarity.html#cb181-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diff_close =</span> <span class="fu">difference</span>(Close)) <span class="sc">|&gt;</span></span>
<span id="cb181-3"><a href="stationarity.html#cb181-3" tabindex="-1"></a>  <span class="fu">features</span>(diff_close, unitroot_kpss)</span>
<span id="cb181-4"><a href="stationarity.html#cb181-4" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1 × 3</span></span>
<span id="cb181-5"><a href="stationarity.html#cb181-5" tabindex="-1"></a><span class="co">#&gt;   Symbol kpss_stat kpss_pvalue</span></span>
<span id="cb181-6"><a href="stationarity.html#cb181-6" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;      &lt;dbl&gt;       &lt;dbl&gt;</span></span>
<span id="cb181-7"><a href="stationarity.html#cb181-7" tabindex="-1"></a><span class="co">#&gt; 1 GOOG      0.0989         0.1</span></span></code></pre></div>
<p>This time, the p-value is reported as 0.1 (and so it could be larger than that). We can conclude that the differenced data appear stationary.</p>
<p>This process of using a sequence of KPSS tests to determine the appropriate number of first differences is carried out using the <code>unitroot_ndiffs()</code> feature.</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="stationarity.html#cb182-1" tabindex="-1"></a>google_2015 <span class="sc">|&gt;</span></span>
<span id="cb182-2"><a href="stationarity.html#cb182-2" tabindex="-1"></a>  <span class="fu">features</span>(Close, unitroot_ndiffs)</span>
<span id="cb182-3"><a href="stationarity.html#cb182-3" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1 × 2</span></span>
<span id="cb182-4"><a href="stationarity.html#cb182-4" tabindex="-1"></a><span class="co">#&gt;   Symbol ndiffs</span></span>
<span id="cb182-5"><a href="stationarity.html#cb182-5" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;   &lt;int&gt;</span></span>
<span id="cb182-6"><a href="stationarity.html#cb182-6" tabindex="-1"></a><span class="co">#&gt; 1 GOOG        1</span></span></code></pre></div>
<p>As we saw from the KPSS tests above, one difference is required to make the <code>google_2015</code> data stationary.</p>
<p>A similar feature for determining whether seasonal differencing is required is <code>unitroot_nsdiffs()</code>, which uses the measure of seasonal strength introduced in Section <a href="stlfeatures.html#stlfeatures">4.3</a> to determine the appropriate number of seasonal differences required. No seasonal differences are suggested if <span class="math inline">\(F_S&lt;0.64\)</span>, otherwise one seasonal difference is suggested.</p>
<p>We can apply <code>unitroot_nsdiffs()</code> to the monthly total Australian retail turnover.</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="stationarity.html#cb183-1" tabindex="-1"></a>aus_total_retail <span class="ot">&lt;-</span> aus_retail <span class="sc">|&gt;</span></span>
<span id="cb183-2"><a href="stationarity.html#cb183-2" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Turnover =</span> <span class="fu">sum</span>(Turnover))</span>
<span id="cb183-3"><a href="stationarity.html#cb183-3" tabindex="-1"></a>aus_total_retail <span class="sc">|&gt;</span></span>
<span id="cb183-4"><a href="stationarity.html#cb183-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log_turnover =</span> <span class="fu">log</span>(Turnover)) <span class="sc">|&gt;</span></span>
<span id="cb183-5"><a href="stationarity.html#cb183-5" tabindex="-1"></a>  <span class="fu">features</span>(log_turnover, unitroot_nsdiffs)</span>
<span id="cb183-6"><a href="stationarity.html#cb183-6" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1 × 1</span></span>
<span id="cb183-7"><a href="stationarity.html#cb183-7" tabindex="-1"></a><span class="co">#&gt;   nsdiffs</span></span>
<span id="cb183-8"><a href="stationarity.html#cb183-8" tabindex="-1"></a><span class="co">#&gt;     &lt;int&gt;</span></span>
<span id="cb183-9"><a href="stationarity.html#cb183-9" tabindex="-1"></a><span class="co">#&gt; 1       1</span></span>
<span id="cb183-10"><a href="stationarity.html#cb183-10" tabindex="-1"></a></span>
<span id="cb183-11"><a href="stationarity.html#cb183-11" tabindex="-1"></a>aus_total_retail <span class="sc">|&gt;</span></span>
<span id="cb183-12"><a href="stationarity.html#cb183-12" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log_turnover =</span> <span class="fu">difference</span>(<span class="fu">log</span>(Turnover), <span class="dv">12</span>)) <span class="sc">|&gt;</span></span>
<span id="cb183-13"><a href="stationarity.html#cb183-13" tabindex="-1"></a>  <span class="fu">features</span>(log_turnover, unitroot_ndiffs)</span>
<span id="cb183-14"><a href="stationarity.html#cb183-14" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1 × 1</span></span>
<span id="cb183-15"><a href="stationarity.html#cb183-15" tabindex="-1"></a><span class="co">#&gt;   ndiffs</span></span>
<span id="cb183-16"><a href="stationarity.html#cb183-16" tabindex="-1"></a><span class="co">#&gt;    &lt;int&gt;</span></span>
<span id="cb183-17"><a href="stationarity.html#cb183-17" tabindex="-1"></a><span class="co">#&gt; 1      1</span></span></code></pre></div>
<p>Because <code>unitroot_nsdiffs()</code> returns 1 (indicating one seasonal difference is required), we apply the <code>unitroot_ndiffs()</code> function to the seasonally differenced data. These functions suggest we should do both a seasonal difference and a first difference.</p>
</div>
</div>
<h3>Bibliography<a href="bibliography.html#bibliography" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-KPSS92" class="csl-entry">
Kwiatkowski, D., Phillips, P. C. B., Schmidt, P., &amp; Shin, Y. (1992). Testing the null hypothesis of stationarity against the alternative of a unit root: How sure are we that economic time series have a unit root? <em>Journal of Econometrics</em>, <em>54</em>(1-3), 159–178. <a href="https://doi.org/10.1016/0304-4076(92)90104-Y">[DOI]</a>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="18">
<li id="fn18"><p>More precisely, if <span class="math inline">\(\{y_t\}\)</span> is a <strong>stationary</strong> time series, then for all <span class="math inline">\(s\)</span>, the distribution of <span class="math inline">\((y_t,\dots,y_{t+s})\)</span> does not depend on <span class="math inline">\(t\)</span>.<a href="stationarity.html#fnref18" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="arima.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="backshift.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
