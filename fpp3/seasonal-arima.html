<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>9.9 Seasonal ARIMA models | Forecasting: Principles and Practice (3rd ed)</title>
  <meta name="description" content="3rd edition" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="9.9 Seasonal ARIMA models | Forecasting: Principles and Practice (3rd ed)" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://Otexts.com/fpp3///figs/fpp3_front_cover.jpg" />
  <meta property="og:description" content="3rd edition" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9.9 Seasonal ARIMA models | Forecasting: Principles and Practice (3rd ed)" />
  <meta name="twitter:site" content="@robjhyndman" />
  <meta name="twitter:description" content="3rd edition" />
  <meta name="twitter:image" content="https://Otexts.com/fpp3///figs/fpp3_front_cover.jpg" />




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="arima-forecasting.html"/>
<link rel="next" href="arima-ets.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { 
    equationNumbers: { autoNumber: "AMS" } ,
    Macros: {
      bm: ["\\boldsymbol{#1}",1],
      y:    ["y_{\\text{#1},#2}",2],
      yhat: ["\\hat{y}_{\\text{#1},#2}",2],
      ytilde: ["\\tilde{y}_{\\text{#1},#2}",2],
      Shat: ["\\hat{S}_{\\text{#1},#2}^{(#3)}",3]
    }
  }
});
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-27933797-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-27933797-2');
  gtag('config', 'G-JKBLG3XQGY');
</script>
<link href="https://fonts.googleapis.com/css?family=Fira+Sans|Merriweather" rel="stylesheet">
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hack-font@3/build/web/hack-subset.css">
<script>
  /*
   * Light YouTube Embeds by @labnol
   * Credit: https://www.labnol.org/
   */

  function labnolIframe(div) {
    var iframe = document.createElement('iframe');
    iframe.setAttribute('src', 'https://www.youtube.com/embed/' + div.dataset.id + '?autoplay=1');
    iframe.setAttribute('frameborder', '0');
    iframe.setAttribute('allowfullscreen', '1');
    iframe.setAttribute('allow', 'accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture');
    div.parentNode.replaceChild(iframe, div);
  }

  function initYouTubeVideos() {
    var playerElements = document.querySelectorAll('.youtube-player');
    for (var n = 0; n < playerElements.length; n++) {
      var videoId = playerElements[n].dataset.id;
      var div = document.createElement('div');
      div.setAttribute('data-id', videoId);
      var thumbNode = document.createElement('img');
      thumbNode.src = '//i.ytimg.com/vi/ID/hqdefault.jpg'.replace('ID', videoId);
      div.appendChild(thumbNode);
      var playButton = document.createElement('div');
      playButton.setAttribute('class', 'play');
      div.appendChild(playButton);
      div.onclick = function () {
        labnolIframe(this);
      };
      playerElements[n].appendChild(div);
    }
  }

  document.addEventListener('DOMContentLoaded', initYouTubeVideos);
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Forecasting: Principles and Practice</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Getting started</a>
<ul>
<li class="chapter" data-level="1.1" data-path="what-can-be-forecast.html"><a href="what-can-be-forecast.html"><i class="fa fa-check"></i><b>1.1</b> What can be forecast?</a></li>
<li class="chapter" data-level="1.2" data-path="planning.html"><a href="planning.html"><i class="fa fa-check"></i><b>1.2</b> Forecasting, goals and planning</a></li>
<li class="chapter" data-level="1.3" data-path="determining-what-to-forecast.html"><a href="determining-what-to-forecast.html"><i class="fa fa-check"></i><b>1.3</b> Determining what to forecast</a></li>
<li class="chapter" data-level="1.4" data-path="data-methods.html"><a href="data-methods.html"><i class="fa fa-check"></i><b>1.4</b> Forecasting data and methods</a></li>
<li class="chapter" data-level="1.5" data-path="case-studies.html"><a href="case-studies.html"><i class="fa fa-check"></i><b>1.5</b> Some case studies</a></li>
<li class="chapter" data-level="1.6" data-path="basic-steps.html"><a href="basic-steps.html"><i class="fa fa-check"></i><b>1.6</b> The basic steps in a forecasting task</a></li>
<li class="chapter" data-level="1.7" data-path="perspective.html"><a href="perspective.html"><i class="fa fa-check"></i><b>1.7</b> The statistical forecasting perspective</a></li>
<li class="chapter" data-level="1.8" data-path="intro-exercises.html"><a href="intro-exercises.html"><i class="fa fa-check"></i><b>1.8</b> Exercises</a></li>
<li class="chapter" data-level="1.9" data-path="intro-reading.html"><a href="intro-reading.html"><i class="fa fa-check"></i><b>1.9</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="graphics.html"><a href="graphics.html"><i class="fa fa-check"></i><b>2</b> Time series graphics</a>
<ul>
<li class="chapter" data-level="2.1" data-path="tsibbles.html"><a href="tsibbles.html"><i class="fa fa-check"></i><b>2.1</b> <code>tsibble</code> objects</a></li>
<li class="chapter" data-level="2.2" data-path="time-plots.html"><a href="time-plots.html"><i class="fa fa-check"></i><b>2.2</b> Time plots</a></li>
<li class="chapter" data-level="2.3" data-path="tspatterns.html"><a href="tspatterns.html"><i class="fa fa-check"></i><b>2.3</b> Time series patterns</a></li>
<li class="chapter" data-level="2.4" data-path="seasonal-plots.html"><a href="seasonal-plots.html"><i class="fa fa-check"></i><b>2.4</b> Seasonal plots</a></li>
<li class="chapter" data-level="2.5" data-path="subseries.html"><a href="subseries.html"><i class="fa fa-check"></i><b>2.5</b> Seasonal subseries plots</a></li>
<li class="chapter" data-level="2.6" data-path="scatterplots.html"><a href="scatterplots.html"><i class="fa fa-check"></i><b>2.6</b> Scatterplots</a></li>
<li class="chapter" data-level="2.7" data-path="lag-plots.html"><a href="lag-plots.html"><i class="fa fa-check"></i><b>2.7</b> Lag plots</a></li>
<li class="chapter" data-level="2.8" data-path="acf.html"><a href="acf.html"><i class="fa fa-check"></i><b>2.8</b> Autocorrelation</a></li>
<li class="chapter" data-level="2.9" data-path="wn.html"><a href="wn.html"><i class="fa fa-check"></i><b>2.9</b> White noise</a></li>
<li class="chapter" data-level="2.10" data-path="graphics-exercises.html"><a href="graphics-exercises.html"><i class="fa fa-check"></i><b>2.10</b> Exercises</a></li>
<li class="chapter" data-level="2.11" data-path="graphics-reading.html"><a href="graphics-reading.html"><i class="fa fa-check"></i><b>2.11</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="decomposition.html"><a href="decomposition.html"><i class="fa fa-check"></i><b>3</b> Time series decomposition</a>
<ul>
<li class="chapter" data-level="3.1" data-path="transformations.html"><a href="transformations.html"><i class="fa fa-check"></i><b>3.1</b> Transformations and adjustments</a></li>
<li class="chapter" data-level="3.2" data-path="components.html"><a href="components.html"><i class="fa fa-check"></i><b>3.2</b> Time series components</a></li>
<li class="chapter" data-level="3.3" data-path="moving-averages.html"><a href="moving-averages.html"><i class="fa fa-check"></i><b>3.3</b> Moving averages</a></li>
<li class="chapter" data-level="3.4" data-path="classical-decomposition.html"><a href="classical-decomposition.html"><i class="fa fa-check"></i><b>3.4</b> Classical decomposition</a></li>
<li class="chapter" data-level="3.5" data-path="methods-used-by-official-statistics-agencies.html"><a href="methods-used-by-official-statistics-agencies.html"><i class="fa fa-check"></i><b>3.5</b> Methods used by official statistics agencies</a></li>
<li class="chapter" data-level="3.6" data-path="stl.html"><a href="stl.html"><i class="fa fa-check"></i><b>3.6</b> STL decomposition</a></li>
<li class="chapter" data-level="3.7" data-path="decomposition-exercises.html"><a href="decomposition-exercises.html"><i class="fa fa-check"></i><b>3.7</b> Exercises</a></li>
<li class="chapter" data-level="3.8" data-path="decomposition-reading.html"><a href="decomposition-reading.html"><i class="fa fa-check"></i><b>3.8</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="features.html"><a href="features.html"><i class="fa fa-check"></i><b>4</b> Time series features</a>
<ul>
<li class="chapter" data-level="4.1" data-path="some-simple-statistics.html"><a href="some-simple-statistics.html"><i class="fa fa-check"></i><b>4.1</b> Some simple statistics</a></li>
<li class="chapter" data-level="4.2" data-path="acf-features.html"><a href="acf-features.html"><i class="fa fa-check"></i><b>4.2</b> ACF features</a></li>
<li class="chapter" data-level="4.3" data-path="stlfeatures.html"><a href="stlfeatures.html"><i class="fa fa-check"></i><b>4.3</b> STL Features</a></li>
<li class="chapter" data-level="4.4" data-path="other-features.html"><a href="other-features.html"><i class="fa fa-check"></i><b>4.4</b> Other features</a></li>
<li class="chapter" data-level="4.5" data-path="exploring-australian-tourism-data.html"><a href="exploring-australian-tourism-data.html"><i class="fa fa-check"></i><b>4.5</b> Exploring Australian tourism data</a></li>
<li class="chapter" data-level="4.6" data-path="feast-exercises.html"><a href="feast-exercises.html"><i class="fa fa-check"></i><b>4.6</b> Exercises</a></li>
<li class="chapter" data-level="4.7" data-path="further-reading.html"><a href="further-reading.html"><i class="fa fa-check"></i><b>4.7</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="toolbox.html"><a href="toolbox.html"><i class="fa fa-check"></i><b>5</b> The forecaster’s toolbox</a>
<ul>
<li class="chapter" data-level="5.1" data-path="a-tidy-forecasting-workflow.html"><a href="a-tidy-forecasting-workflow.html"><i class="fa fa-check"></i><b>5.1</b> A tidy forecasting workflow</a></li>
<li class="chapter" data-level="5.2" data-path="simple-methods.html"><a href="simple-methods.html"><i class="fa fa-check"></i><b>5.2</b> Some simple forecasting methods</a></li>
<li class="chapter" data-level="5.3" data-path="residuals.html"><a href="residuals.html"><i class="fa fa-check"></i><b>5.3</b> Fitted values and residuals</a></li>
<li class="chapter" data-level="5.4" data-path="diagnostics.html"><a href="diagnostics.html"><i class="fa fa-check"></i><b>5.4</b> Residual diagnostics</a></li>
<li class="chapter" data-level="5.5" data-path="prediction-intervals.html"><a href="prediction-intervals.html"><i class="fa fa-check"></i><b>5.5</b> Distributional forecasts and prediction intervals</a></li>
<li class="chapter" data-level="5.6" data-path="ftransformations.html"><a href="ftransformations.html"><i class="fa fa-check"></i><b>5.6</b> Forecasting using transformations</a></li>
<li class="chapter" data-level="5.7" data-path="forecasting-decomposition.html"><a href="forecasting-decomposition.html"><i class="fa fa-check"></i><b>5.7</b> Forecasting with decomposition</a></li>
<li class="chapter" data-level="5.8" data-path="accuracy.html"><a href="accuracy.html"><i class="fa fa-check"></i><b>5.8</b> Evaluating point forecast accuracy</a></li>
<li class="chapter" data-level="5.9" data-path="distaccuracy.html"><a href="distaccuracy.html"><i class="fa fa-check"></i><b>5.9</b> Evaluating distributional forecast accuracy</a></li>
<li class="chapter" data-level="5.10" data-path="tscv.html"><a href="tscv.html"><i class="fa fa-check"></i><b>5.10</b> Time series cross-validation</a></li>
<li class="chapter" data-level="5.11" data-path="toolbox-exercises.html"><a href="toolbox-exercises.html"><i class="fa fa-check"></i><b>5.11</b> Exercises</a></li>
<li class="chapter" data-level="5.12" data-path="basics-reading.html"><a href="basics-reading.html"><i class="fa fa-check"></i><b>5.12</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="judgmental.html"><a href="judgmental.html"><i class="fa fa-check"></i><b>6</b> Judgmental forecasts</a>
<ul>
<li class="chapter" data-level="6.1" data-path="judgmental-limitations.html"><a href="judgmental-limitations.html"><i class="fa fa-check"></i><b>6.1</b> Beware of limitations</a></li>
<li class="chapter" data-level="6.2" data-path="judgmental-principles.html"><a href="judgmental-principles.html"><i class="fa fa-check"></i><b>6.2</b> Key principles</a></li>
<li class="chapter" data-level="6.3" data-path="delphimethod.html"><a href="delphimethod.html"><i class="fa fa-check"></i><b>6.3</b> The Delphi method</a></li>
<li class="chapter" data-level="6.4" data-path="analogies.html"><a href="analogies.html"><i class="fa fa-check"></i><b>6.4</b> Forecasting by analogy</a></li>
<li class="chapter" data-level="6.5" data-path="scenarios.html"><a href="scenarios.html"><i class="fa fa-check"></i><b>6.5</b> Scenario forecasting</a></li>
<li class="chapter" data-level="6.6" data-path="new-products.html"><a href="new-products.html"><i class="fa fa-check"></i><b>6.6</b> New product forecasting</a></li>
<li class="chapter" data-level="6.7" data-path="judgmental-adjustments.html"><a href="judgmental-adjustments.html"><i class="fa fa-check"></i><b>6.7</b> Judgmental adjustments</a></li>
<li class="chapter" data-level="6.8" data-path="judgmental-reading.html"><a href="judgmental-reading.html"><i class="fa fa-check"></i><b>6.8</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>7</b> Time series regression models</a>
<ul>
<li class="chapter" data-level="7.1" data-path="regression-intro.html"><a href="regression-intro.html"><i class="fa fa-check"></i><b>7.1</b> The linear model</a></li>
<li class="chapter" data-level="7.2" data-path="least-squares.html"><a href="least-squares.html"><i class="fa fa-check"></i><b>7.2</b> Least squares estimation</a></li>
<li class="chapter" data-level="7.3" data-path="regression-evaluation.html"><a href="regression-evaluation.html"><i class="fa fa-check"></i><b>7.3</b> Evaluating the regression model</a></li>
<li class="chapter" data-level="7.4" data-path="useful-predictors.html"><a href="useful-predictors.html"><i class="fa fa-check"></i><b>7.4</b> Some useful predictors</a></li>
<li class="chapter" data-level="7.5" data-path="selecting-predictors.html"><a href="selecting-predictors.html"><i class="fa fa-check"></i><b>7.5</b> Selecting predictors</a></li>
<li class="chapter" data-level="7.6" data-path="forecasting-regression.html"><a href="forecasting-regression.html"><i class="fa fa-check"></i><b>7.6</b> Forecasting with regression</a></li>
<li class="chapter" data-level="7.7" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html"><i class="fa fa-check"></i><b>7.7</b> Nonlinear regression</a></li>
<li class="chapter" data-level="7.8" data-path="causality.html"><a href="causality.html"><i class="fa fa-check"></i><b>7.8</b> Correlation, causation and forecasting</a></li>
<li class="chapter" data-level="7.9" data-path="regression-matrices.html"><a href="regression-matrices.html"><i class="fa fa-check"></i><b>7.9</b> Matrix formulation</a></li>
<li class="chapter" data-level="7.10" data-path="regression-exercises.html"><a href="regression-exercises.html"><i class="fa fa-check"></i><b>7.10</b> Exercises</a></li>
<li class="chapter" data-level="7.11" data-path="regression-reading.html"><a href="regression-reading.html"><i class="fa fa-check"></i><b>7.11</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="expsmooth.html"><a href="expsmooth.html"><i class="fa fa-check"></i><b>8</b> Exponential smoothing</a>
<ul>
<li class="chapter" data-level="8.1" data-path="ses.html"><a href="ses.html"><i class="fa fa-check"></i><b>8.1</b> Simple exponential smoothing</a></li>
<li class="chapter" data-level="8.2" data-path="holt.html"><a href="holt.html"><i class="fa fa-check"></i><b>8.2</b> Methods with trend</a></li>
<li class="chapter" data-level="8.3" data-path="holt-winters.html"><a href="holt-winters.html"><i class="fa fa-check"></i><b>8.3</b> Methods with seasonality</a></li>
<li class="chapter" data-level="8.4" data-path="taxonomy.html"><a href="taxonomy.html"><i class="fa fa-check"></i><b>8.4</b> A taxonomy of exponential smoothing methods</a></li>
<li class="chapter" data-level="8.5" data-path="ets.html"><a href="ets.html"><i class="fa fa-check"></i><b>8.5</b> Innovations state space models for exponential smoothing</a></li>
<li class="chapter" data-level="8.6" data-path="ets-estimation.html"><a href="ets-estimation.html"><i class="fa fa-check"></i><b>8.6</b> Estimation and model selection</a></li>
<li class="chapter" data-level="8.7" data-path="ets-forecasting.html"><a href="ets-forecasting.html"><i class="fa fa-check"></i><b>8.7</b> Forecasting with ETS models</a></li>
<li class="chapter" data-level="8.8" data-path="expsmooth-exercises.html"><a href="expsmooth-exercises.html"><i class="fa fa-check"></i><b>8.8</b> Exercises</a></li>
<li class="chapter" data-level="8.9" data-path="expsmooth-reading.html"><a href="expsmooth-reading.html"><i class="fa fa-check"></i><b>8.9</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="arima.html"><a href="arima.html"><i class="fa fa-check"></i><b>9</b> ARIMA models</a>
<ul>
<li class="chapter" data-level="9.1" data-path="stationarity.html"><a href="stationarity.html"><i class="fa fa-check"></i><b>9.1</b> Stationarity and differencing</a></li>
<li class="chapter" data-level="9.2" data-path="backshift.html"><a href="backshift.html"><i class="fa fa-check"></i><b>9.2</b> Backshift notation</a></li>
<li class="chapter" data-level="9.3" data-path="AR.html"><a href="AR.html"><i class="fa fa-check"></i><b>9.3</b> Autoregressive models</a></li>
<li class="chapter" data-level="9.4" data-path="MA.html"><a href="MA.html"><i class="fa fa-check"></i><b>9.4</b> Moving average models</a></li>
<li class="chapter" data-level="9.5" data-path="non-seasonal-arima.html"><a href="non-seasonal-arima.html"><i class="fa fa-check"></i><b>9.5</b> Non-seasonal ARIMA models</a></li>
<li class="chapter" data-level="9.6" data-path="arima-estimation.html"><a href="arima-estimation.html"><i class="fa fa-check"></i><b>9.6</b> Estimation and order selection</a></li>
<li class="chapter" data-level="9.7" data-path="arima-r.html"><a href="arima-r.html"><i class="fa fa-check"></i><b>9.7</b> ARIMA modelling in <code>fable</code></a></li>
<li class="chapter" data-level="9.8" data-path="arima-forecasting.html"><a href="arima-forecasting.html"><i class="fa fa-check"></i><b>9.8</b> Forecasting</a></li>
<li class="chapter" data-level="9.9" data-path="seasonal-arima.html"><a href="seasonal-arima.html"><i class="fa fa-check"></i><b>9.9</b> Seasonal ARIMA models</a></li>
<li class="chapter" data-level="9.10" data-path="arima-ets.html"><a href="arima-ets.html"><i class="fa fa-check"></i><b>9.10</b> ARIMA vs ETS</a></li>
<li class="chapter" data-level="9.11" data-path="arima-exercises.html"><a href="arima-exercises.html"><i class="fa fa-check"></i><b>9.11</b> Exercises</a></li>
<li class="chapter" data-level="9.12" data-path="arima-reading.html"><a href="arima-reading.html"><i class="fa fa-check"></i><b>9.12</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="dynamic.html"><a href="dynamic.html"><i class="fa fa-check"></i><b>10</b> Dynamic regression models</a>
<ul>
<li class="chapter" data-level="10.1" data-path="estimation.html"><a href="estimation.html"><i class="fa fa-check"></i><b>10.1</b> Estimation</a></li>
<li class="chapter" data-level="10.2" data-path="regarima.html"><a href="regarima.html"><i class="fa fa-check"></i><b>10.2</b> Regression with ARIMA errors using <code>fable</code></a></li>
<li class="chapter" data-level="10.3" data-path="forecasting.html"><a href="forecasting.html"><i class="fa fa-check"></i><b>10.3</b> Forecasting</a></li>
<li class="chapter" data-level="10.4" data-path="stochastic-and-deterministic-trends.html"><a href="stochastic-and-deterministic-trends.html"><i class="fa fa-check"></i><b>10.4</b> Stochastic and deterministic trends</a></li>
<li class="chapter" data-level="10.5" data-path="dhr.html"><a href="dhr.html"><i class="fa fa-check"></i><b>10.5</b> Dynamic harmonic regression</a></li>
<li class="chapter" data-level="10.6" data-path="lagged-predictors.html"><a href="lagged-predictors.html"><i class="fa fa-check"></i><b>10.6</b> Lagged predictors</a></li>
<li class="chapter" data-level="10.7" data-path="dynamic-exercises.html"><a href="dynamic-exercises.html"><i class="fa fa-check"></i><b>10.7</b> Exercises</a></li>
<li class="chapter" data-level="10.8" data-path="dynamic-reading.html"><a href="dynamic-reading.html"><i class="fa fa-check"></i><b>10.8</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="hierarchical.html"><a href="hierarchical.html"><i class="fa fa-check"></i><b>11</b> Forecasting hierarchical and grouped time series</a>
<ul>
<li class="chapter" data-level="11.1" data-path="hts.html"><a href="hts.html"><i class="fa fa-check"></i><b>11.1</b> Hierarchical and grouped time series</a></li>
<li class="chapter" data-level="11.2" data-path="single-level.html"><a href="single-level.html"><i class="fa fa-check"></i><b>11.2</b> Single level approaches</a></li>
<li class="chapter" data-level="11.3" data-path="reconciliation.html"><a href="reconciliation.html"><i class="fa fa-check"></i><b>11.3</b> Forecast reconciliation</a></li>
<li class="chapter" data-level="11.4" data-path="tourism.html"><a href="tourism.html"><i class="fa fa-check"></i><b>11.4</b> Forecasting Australian domestic tourism</a></li>
<li class="chapter" data-level="11.5" data-path="rec-prob.html"><a href="rec-prob.html"><i class="fa fa-check"></i><b>11.5</b> Reconciled distributional forecasts</a></li>
<li class="chapter" data-level="11.6" data-path="prison.html"><a href="prison.html"><i class="fa fa-check"></i><b>11.6</b> Forecasting Australian prison population</a></li>
<li class="chapter" data-level="11.7" data-path="hierarchical-exercises.html"><a href="hierarchical-exercises.html"><i class="fa fa-check"></i><b>11.7</b> Exercises</a></li>
<li class="chapter" data-level="11.8" data-path="hierarchical-reading.html"><a href="hierarchical-reading.html"><i class="fa fa-check"></i><b>11.8</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="advanced.html"><a href="advanced.html"><i class="fa fa-check"></i><b>12</b> Advanced forecasting methods</a>
<ul>
<li class="chapter" data-level="12.1" data-path="complexseasonality.html"><a href="complexseasonality.html"><i class="fa fa-check"></i><b>12.1</b> Complex seasonality</a></li>
<li class="chapter" data-level="12.2" data-path="prophet.html"><a href="prophet.html"><i class="fa fa-check"></i><b>12.2</b> Prophet model</a></li>
<li class="chapter" data-level="12.3" data-path="VAR.html"><a href="VAR.html"><i class="fa fa-check"></i><b>12.3</b> Vector autoregressions</a></li>
<li class="chapter" data-level="12.4" data-path="nnetar.html"><a href="nnetar.html"><i class="fa fa-check"></i><b>12.4</b> Neural network models</a></li>
<li class="chapter" data-level="12.5" data-path="bootstrap.html"><a href="bootstrap.html"><i class="fa fa-check"></i><b>12.5</b> Bootstrapping and bagging</a></li>
<li class="chapter" data-level="12.6" data-path="advanced-exercises.html"><a href="advanced-exercises.html"><i class="fa fa-check"></i><b>12.6</b> Exercises</a></li>
<li class="chapter" data-level="12.7" data-path="advanced-reading.html"><a href="advanced-reading.html"><i class="fa fa-check"></i><b>12.7</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="practical.html"><a href="practical.html"><i class="fa fa-check"></i><b>13</b> Some practical forecasting issues</a>
<ul>
<li class="chapter" data-level="13.1" data-path="weekly.html"><a href="weekly.html"><i class="fa fa-check"></i><b>13.1</b> Weekly, daily and sub-daily data</a></li>
<li class="chapter" data-level="13.2" data-path="counts.html"><a href="counts.html"><i class="fa fa-check"></i><b>13.2</b> Time series of counts</a></li>
<li class="chapter" data-level="13.3" data-path="limits.html"><a href="limits.html"><i class="fa fa-check"></i><b>13.3</b> Ensuring forecasts stay within limits</a></li>
<li class="chapter" data-level="13.4" data-path="combinations.html"><a href="combinations.html"><i class="fa fa-check"></i><b>13.4</b> Forecast combinations</a></li>
<li class="chapter" data-level="13.5" data-path="aggregates.html"><a href="aggregates.html"><i class="fa fa-check"></i><b>13.5</b> Prediction intervals for aggregates</a></li>
<li class="chapter" data-level="13.6" data-path="backcasting.html"><a href="backcasting.html"><i class="fa fa-check"></i><b>13.6</b> Backcasting</a></li>
<li class="chapter" data-level="13.7" data-path="long-short-ts.html"><a href="long-short-ts.html"><i class="fa fa-check"></i><b>13.7</b> Very long and very short time series</a></li>
<li class="chapter" data-level="13.8" data-path="training-test.html"><a href="training-test.html"><i class="fa fa-check"></i><b>13.8</b> Forecasting on training and test sets</a></li>
<li class="chapter" data-level="13.9" data-path="missing-outliers.html"><a href="missing-outliers.html"><i class="fa fa-check"></i><b>13.9</b> Dealing with outliers and missing values</a></li>
<li class="chapter" data-level="13.10" data-path="further-reading-1.html"><a href="further-reading-1.html"><i class="fa fa-check"></i><b>13.10</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-using-r.html"><a href="appendix-using-r.html"><i class="fa fa-check"></i>Appendix: Using R</a></li>
<li class="chapter" data-level="" data-path="appendix-for-instructors.html"><a href="appendix-for-instructors.html"><i class="fa fa-check"></i>Appendix: For instructors</a></li>
<li class="chapter" data-level="" data-path="appendix-reviews.html"><a href="appendix-reviews.html"><i class="fa fa-check"></i>Appendix: Reviews</a></li>
<li class="chapter" data-level="" data-path="translations.html"><a href="translations.html"><i class="fa fa-check"></i>Translations</a></li>
<li class="chapter" data-level="" data-path="about-the-authors.html"><a href="about-the-authors.html"><i class="fa fa-check"></i>About the authors</a></li>
<li class="chapter" data-level="" data-path="buy-a-print-version.html"><a href="buy-a-print-version.html"><i class="fa fa-check"></i>Buy a print version</a></li>
<li class="chapter" data-level="" data-path="report-an-error.html"><a href="report-an-error.html"><i class="fa fa-check"></i>Report an error</a></li>
<li class="chapter" data-level="" data-path="bibliography.html"><a href="bibliography.html"><i class="fa fa-check"></i>Bibliography</a></li>
<li class="divider"></li>
<li><a href="https://OTexts.com" target="blank">Published by OTexts™ with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Forecasting: Principles and Practice <font size=-1>(3rd ed)</font></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="seasonal-arima" class="section level2 hasAnchor" number="9.9">
<h2><span class="header-section-number">9.9</span> Seasonal ARIMA models<a href="seasonal-arima.html#seasonal-arima" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="youtube-player" data-id="B-VlebWlZX4">

</div>
<p>So far, we have restricted our attention to non-seasonal data and non-seasonal ARIMA models. However, ARIMA models are also capable of modelling a wide range of seasonal data.</p>
<p>A seasonal ARIMA model is formed by including additional seasonal terms in the ARIMA models we have seen so far. It is written as follows:</p>
<table style="width:auto;" align="center">
<tr style="border-top-width: 0px !important; background-color:#ffffff;">
<td align="right">
ARIMA
</td>
<td align="center">
<span class="math inline"><span class="math inline">\(\underbrace{(p, d, q)}\)</span></span>
</td>
<td align="center">
<span class="math inline"><span class="math inline">\(\underbrace{(P, D, Q)_{m}}\)</span></span>
</td>
</tr>
<tr style="border-top-width: 0px !important;background-color:#ffffff;">
<td align="right">
</td>
<td align="center">
<span class="math inline"><span class="math inline">\({\uparrow}\)</span></span>
</td>
<td align="center">
<span class="math inline"><span class="math inline">\({\uparrow}\)</span></span>
</td>
</tr>
<tr style="border-top-width: 0px !important;background-color:#ffffff;">
<td align="right">
</td>
<td align="center">
Non-seasonal part
</td>
<td align="center">
Seasonal part
</td>
</tr>
<tr style="border-top-width: 0px !important;background-color:#ffffff;">
<td align="right">
</td>
<td align="center">
of the model
</td>
<td align="center">
of the model
</td>
</tr>
</table>
<p>where <span class="math inline">\(m =\)</span> the seasonal period (e.g., number of observations per year). We use uppercase notation for the seasonal parts of the model, and lowercase notation for the non-seasonal parts of the model.</p>
<p>The seasonal part of the model consists of terms that are similar to the non-seasonal components of the model, but involve backshifts of the seasonal period. For example, an ARIMA(1,1,1)(1,1,1)<span class="math inline">\(_{4}\)</span> model (without a constant) is for quarterly data (<span class="math inline">\(m=4\)</span>), and can be written as
<span class="math display">\[
  (1 - \phi_{1}B)~(1 - \Phi_{1}B^{4}) (1 - B) (1 - B^{4})y_{t} =
  (1 + \theta_{1}B)~ (1 + \Theta_{1}B^{4})\varepsilon_{t}.
\]</span></p>
<p>The additional seasonal terms are simply multiplied by the non-seasonal terms.</p>
<div id="acfpacf" class="section level3 unnumbered hasAnchor">
<h3>ACF/PACF<a href="seasonal-arima.html#acfpacf" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The seasonal part of an AR or MA model will be seen in the seasonal lags of the PACF and ACF. For example, an ARIMA(0,0,0)(0,0,1)<span class="math inline">\(_{12}\)</span> model will show:</p>
<ul>
<li>a spike at lag 12 in the ACF but no other significant spikes;</li>
<li>exponential decay in the seasonal lags of the PACF (i.e., at lags 12, 24, 36, …).</li>
</ul>
<p>Similarly, an ARIMA(0,0,0)(1,0,0)<span class="math inline">\(_{12}\)</span> model will show:</p>
<ul>
<li>exponential decay in the seasonal lags of the ACF;</li>
<li>a single significant spike at lag 12 in the PACF.</li>
</ul>
<p>In considering the appropriate seasonal orders for a seasonal ARIMA model, restrict attention to the seasonal lags.</p>
<p>The modelling procedure is almost the same as for non-seasonal data, except that we need to select seasonal AR and MA terms as well as the non-seasonal components of the model. The process is best illustrated via examples.</p>
</div>
<div id="example-monthly-us-leisure-and-hospitality-employment" class="section level3 unnumbered hasAnchor">
<h3>Example: Monthly US leisure and hospitality employment<a href="seasonal-arima.html#example-monthly-us-leisure-and-hospitality-employment" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We will describe seasonal ARIMA modelling using monthly US employment data for leisure and hospitality jobs from January 2001 to September 2019, shown in Figure <a href="seasonal-arima.html#fig:usemployment1">9.18</a>.</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="seasonal-arima.html#cb197-1" tabindex="-1"></a>leisure <span class="ot">&lt;-</span> us_employment <span class="sc">|&gt;</span></span>
<span id="cb197-2"><a href="seasonal-arima.html#cb197-2" tabindex="-1"></a>  <span class="fu">filter</span>(Title <span class="sc">==</span> <span class="st">&quot;Leisure and Hospitality&quot;</span>,</span>
<span id="cb197-3"><a href="seasonal-arima.html#cb197-3" tabindex="-1"></a>         <span class="fu">year</span>(Month) <span class="sc">&gt;</span> <span class="dv">2000</span>) <span class="sc">|&gt;</span></span>
<span id="cb197-4"><a href="seasonal-arima.html#cb197-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Employed =</span> Employed<span class="sc">/</span><span class="dv">1000</span>) <span class="sc">|&gt;</span></span>
<span id="cb197-5"><a href="seasonal-arima.html#cb197-5" tabindex="-1"></a>  <span class="fu">select</span>(Month, Employed)</span>
<span id="cb197-6"><a href="seasonal-arima.html#cb197-6" tabindex="-1"></a><span class="fu">autoplot</span>(leisure, Employed) <span class="sc">+</span></span>
<span id="cb197-7"><a href="seasonal-arima.html#cb197-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;US employment: leisure and hospitality&quot;</span>,</span>
<span id="cb197-8"><a href="seasonal-arima.html#cb197-8" tabindex="-1"></a>       <span class="at">y=</span><span class="st">&quot;Number of people (millions)&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:usemployment1"></span>
<img src="fpp_files/figure-html/usemployment1-1.png" alt="Monthly US leisure and hospitality employment, 2001-2019." width="100%" />
<p class="caption">
Figure 9.18: Monthly US leisure and hospitality employment, 2001-2019.
</p>
</div>
<p>The data are clearly non-stationary, with strong seasonality and a nonlinear trend, so we will first take a seasonal difference. The seasonally differenced data are shown in Figure <a href="seasonal-arima.html#fig:usemployment2">9.19</a>.</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="seasonal-arima.html#cb198-1" tabindex="-1"></a>leisure <span class="sc">|&gt;</span></span>
<span id="cb198-2"><a href="seasonal-arima.html#cb198-2" tabindex="-1"></a>  <span class="fu">gg_tsdisplay</span>(<span class="fu">difference</span>(Employed, <span class="dv">12</span>),</span>
<span id="cb198-3"><a href="seasonal-arima.html#cb198-3" tabindex="-1"></a>               <span class="at">plot_type=</span><span class="st">&#39;partial&#39;</span>, <span class="at">lag=</span><span class="dv">36</span>) <span class="sc">+</span></span>
<span id="cb198-4"><a href="seasonal-arima.html#cb198-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Seasonally differenced&quot;</span>, <span class="at">y=</span><span class="st">&quot;&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:usemployment2"></span>
<img src="fpp_files/figure-html/usemployment2-1.png" alt="Seasonally differenced Monthly US leisure and hospitality employment." width="100%" />
<p class="caption">
Figure 9.19: Seasonally differenced Monthly US leisure and hospitality employment.
</p>
</div>
<p>These are also clearly non-stationary, so we take a further first difference in Figure <a href="seasonal-arima.html#fig:usemployment3">9.20</a>.</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="seasonal-arima.html#cb199-1" tabindex="-1"></a>leisure <span class="sc">|&gt;</span></span>
<span id="cb199-2"><a href="seasonal-arima.html#cb199-2" tabindex="-1"></a>  <span class="fu">gg_tsdisplay</span>(<span class="fu">difference</span>(Employed, <span class="dv">12</span>) <span class="sc">|&gt;</span> <span class="fu">difference</span>(),</span>
<span id="cb199-3"><a href="seasonal-arima.html#cb199-3" tabindex="-1"></a>               <span class="at">plot_type=</span><span class="st">&#39;partial&#39;</span>, <span class="at">lag=</span><span class="dv">36</span>) <span class="sc">+</span></span>
<span id="cb199-4"><a href="seasonal-arima.html#cb199-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Double differenced&quot;</span>, <span class="at">y=</span><span class="st">&quot;&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:usemployment3"></span>
<img src="fpp_files/figure-html/usemployment3-1.png" alt="Double differenced Monthly US leisure and hospitality employment." width="100%" />
<p class="caption">
Figure 9.20: Double differenced Monthly US leisure and hospitality employment.
</p>
</div>
<p>Our aim now is to find an appropriate ARIMA model based on the ACF and PACF shown in Figure <a href="seasonal-arima.html#fig:usemployment3">9.20</a>. The significant spike at lag 2 in the ACF suggests a non-seasonal MA(2) component. The significant spike at lag 12 in the ACF suggests a seasonal MA(1) component. Consequently, we begin with an ARIMA(0,1,2)(0,1,1)<span class="math inline">\(_{12}\)</span> model, indicating a first difference, a seasonal difference, and non-seasonal MA(2) and seasonal MA(1) component. If we had started with the PACF, we may have selected an ARIMA(2,1,0)(0,1,1)<span class="math inline">\(_{12}\)</span> model — using the PACF to select the non-seasonal part of the model and the ACF to select the seasonal part of the model. We will also include an automatically selected model. By setting <code>stepwise=FALSE</code> and <code>approximation=FALSE</code>, we are making R work extra hard to find a good model. This takes much longer, but with only one series to model, the extra time taken is not a problem.</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="seasonal-arima.html#cb200-1" tabindex="-1"></a>fit <span class="ot">&lt;-</span> leisure <span class="sc">|&gt;</span></span>
<span id="cb200-2"><a href="seasonal-arima.html#cb200-2" tabindex="-1"></a>  <span class="fu">model</span>(</span>
<span id="cb200-3"><a href="seasonal-arima.html#cb200-3" tabindex="-1"></a>    <span class="at">arima012011 =</span> <span class="fu">ARIMA</span>(Employed <span class="sc">~</span> <span class="fu">pdq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>) <span class="sc">+</span> <span class="fu">PDQ</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>)),</span>
<span id="cb200-4"><a href="seasonal-arima.html#cb200-4" tabindex="-1"></a>    <span class="at">arima210011 =</span> <span class="fu">ARIMA</span>(Employed <span class="sc">~</span> <span class="fu">pdq</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">0</span>) <span class="sc">+</span> <span class="fu">PDQ</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>)),</span>
<span id="cb200-5"><a href="seasonal-arima.html#cb200-5" tabindex="-1"></a>    <span class="at">auto =</span> <span class="fu">ARIMA</span>(Employed, <span class="at">stepwise =</span> <span class="cn">FALSE</span>, <span class="at">approx =</span> <span class="cn">FALSE</span>)</span>
<span id="cb200-6"><a href="seasonal-arima.html#cb200-6" tabindex="-1"></a>  )</span>
<span id="cb200-7"><a href="seasonal-arima.html#cb200-7" tabindex="-1"></a>fit <span class="sc">|&gt;</span> <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">&quot;Model name&quot;</span>,</span>
<span id="cb200-8"><a href="seasonal-arima.html#cb200-8" tabindex="-1"></a>                     <span class="at">values_to =</span> <span class="st">&quot;Orders&quot;</span>)</span>
<span id="cb200-9"><a href="seasonal-arima.html#cb200-9" tabindex="-1"></a><span class="co">#&gt; # A mable: 3 x 2</span></span>
<span id="cb200-10"><a href="seasonal-arima.html#cb200-10" tabindex="-1"></a><span class="co">#&gt; # Key:     Model name [3]</span></span>
<span id="cb200-11"><a href="seasonal-arima.html#cb200-11" tabindex="-1"></a><span class="co">#&gt;   `Model name`                    Orders</span></span>
<span id="cb200-12"><a href="seasonal-arima.html#cb200-12" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;                          &lt;model&gt;</span></span>
<span id="cb200-13"><a href="seasonal-arima.html#cb200-13" tabindex="-1"></a><span class="co">#&gt; 1 arima012011  &lt;ARIMA(0,1,2)(0,1,1)[12]&gt;</span></span>
<span id="cb200-14"><a href="seasonal-arima.html#cb200-14" tabindex="-1"></a><span class="co">#&gt; 2 arima210011  &lt;ARIMA(2,1,0)(0,1,1)[12]&gt;</span></span>
<span id="cb200-15"><a href="seasonal-arima.html#cb200-15" tabindex="-1"></a><span class="co">#&gt; 3 auto         &lt;ARIMA(2,1,0)(1,1,1)[12]&gt;</span></span>
<span id="cb200-16"><a href="seasonal-arima.html#cb200-16" tabindex="-1"></a><span class="fu">glance</span>(fit) <span class="sc">|&gt;</span> <span class="fu">arrange</span>(AICc) <span class="sc">|&gt;</span> <span class="fu">select</span>(.model<span class="sc">:</span>BIC)</span>
<span id="cb200-17"><a href="seasonal-arima.html#cb200-17" tabindex="-1"></a><span class="co">#&gt; # A tibble: 3 × 6</span></span>
<span id="cb200-18"><a href="seasonal-arima.html#cb200-18" tabindex="-1"></a><span class="co">#&gt;   .model       sigma2 log_lik   AIC  AICc   BIC</span></span>
<span id="cb200-19"><a href="seasonal-arima.html#cb200-19" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;         &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb200-20"><a href="seasonal-arima.html#cb200-20" tabindex="-1"></a><span class="co">#&gt; 1 auto        0.00142    395. -780. -780. -763.</span></span>
<span id="cb200-21"><a href="seasonal-arima.html#cb200-21" tabindex="-1"></a><span class="co">#&gt; 2 arima210011 0.00145    392. -776. -776. -763.</span></span>
<span id="cb200-22"><a href="seasonal-arima.html#cb200-22" tabindex="-1"></a><span class="co">#&gt; 3 arima012011 0.00146    391. -775. -775. -761.</span></span></code></pre></div>
<p>The <code>ARIMA()</code> function uses <code>unitroot_nsdiffs()</code> to determine <span class="math inline">\(D\)</span> (the number of seasonal differences to use), and <code>unitroot_ndiffs()</code> to determine <span class="math inline">\(d\)</span> (the number of ordinary differences to use), when these are not specified. The selection of the other model parameters (<span class="math inline">\(p,q,P\)</span> and <span class="math inline">\(Q\)</span>) are all determined by minimizing the AICc, as with non-seasonal ARIMA models.</p>
<p>The three fitted models have similar AICc values, with the automatically selected model being a little better. Our second “guess” of ARIMA(2,1,0)(0,1,1)<span class="math inline">\(_{12}\)</span> turned out to be very close to the automatically selected model of ARIMA(2,1,0)(1,1,1)<span class="math inline">\(_{12}\)</span>.</p>
<p>The residuals for the best model are shown in Figure <a href="seasonal-arima.html#fig:usemployment5">9.21</a>.</p>

<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="seasonal-arima.html#cb201-1" tabindex="-1"></a>fit <span class="sc">|&gt;</span> <span class="fu">select</span>(auto) <span class="sc">|&gt;</span> <span class="fu">gg_tsresiduals</span>(<span class="at">lag=</span><span class="dv">36</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:usemployment5"></span>
<img src="fpp_files/figure-html/usemployment5-1.png" alt="Residuals from the fitted ARIMA(2,1,0)(1,1,1)\(_{12}\) model." width="100%" />
<p class="caption">
Figure 9.21: Residuals from the fitted ARIMA(2,1,0)(1,1,1)<span class="math inline">\(_{12}\)</span> model.
</p>
</div>
<p>One small but significant spike (at lag 11) out of 36 is still consistent with white noise. To be sure, we use a Ljung-Box test, being careful to set the degrees of freedom to match the number of parameters in the model.</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="seasonal-arima.html#cb202-1" tabindex="-1"></a><span class="fu">augment</span>(fit) <span class="sc">|&gt;</span></span>
<span id="cb202-2"><a href="seasonal-arima.html#cb202-2" tabindex="-1"></a>  <span class="fu">filter</span>(.model <span class="sc">==</span> <span class="st">&quot;auto&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb202-3"><a href="seasonal-arima.html#cb202-3" tabindex="-1"></a>  <span class="fu">features</span>(.innov, ljung_box, <span class="at">lag=</span><span class="dv">24</span>, <span class="at">dof=</span><span class="dv">4</span>)</span>
<span id="cb202-4"><a href="seasonal-arima.html#cb202-4" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1 × 3</span></span>
<span id="cb202-5"><a href="seasonal-arima.html#cb202-5" tabindex="-1"></a><span class="co">#&gt;   .model lb_stat lb_pvalue</span></span>
<span id="cb202-6"><a href="seasonal-arima.html#cb202-6" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;    &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span id="cb202-7"><a href="seasonal-arima.html#cb202-7" tabindex="-1"></a><span class="co">#&gt; 1 auto      16.6     0.680</span></span></code></pre></div>
<p>The large p-value confims that the residuals are similar to white noise.</p>
<p>Thus, we now have a seasonal ARIMA model that passes the required checks and is ready for forecasting. Forecasts from the model for the next three years are shown in Figure <a href="seasonal-arima.html#fig:usemployment7">9.22</a>. The forecasts have captured the seasonal pattern very well, and the increasing trend extends the recent pattern. The trend in the forecasts is induced by the double differencing.</p>

<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="seasonal-arima.html#cb203-1" tabindex="-1"></a><span class="fu">forecast</span>(fit, <span class="at">h=</span><span class="dv">36</span>) <span class="sc">|&gt;</span></span>
<span id="cb203-2"><a href="seasonal-arima.html#cb203-2" tabindex="-1"></a>  <span class="fu">filter</span>(.model<span class="sc">==</span><span class="st">&#39;auto&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb203-3"><a href="seasonal-arima.html#cb203-3" tabindex="-1"></a>  <span class="fu">autoplot</span>(leisure) <span class="sc">+</span></span>
<span id="cb203-4"><a href="seasonal-arima.html#cb203-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;US employment: leisure and hospitality&quot;</span>,</span>
<span id="cb203-5"><a href="seasonal-arima.html#cb203-5" tabindex="-1"></a>       <span class="at">y=</span><span class="st">&quot;Number of people (millions)&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:usemployment7"></span>
<img src="fpp_files/figure-html/usemployment7-1.png" alt="Forecasts of monthly US leisure and hospitality employment using the ARIMA(2,1,0)(1,1,1)\(_{12}\) model. 80% and 95% prediction intervals are shown." width="100%" />
<p class="caption">
Figure 9.22: Forecasts of monthly US leisure and hospitality employment using the ARIMA(2,1,0)(1,1,1)<span class="math inline">\(_{12}\)</span> model. 80% and 95% prediction intervals are shown.
</p>
</div>
</div>
<div id="example-corticosteroid-drug-sales-in-australia" class="section level3 unnumbered hasAnchor">
<h3>Example: Corticosteroid drug sales in Australia<a href="seasonal-arima.html#example-corticosteroid-drug-sales-in-australia" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For our second example, we will try to forecast monthly corticosteroid drug sales in Australia. These are known as H02 drugs under the Anatomical Therapeutic Chemical classification scheme.</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="seasonal-arima.html#cb204-1" tabindex="-1"></a>h02 <span class="ot">&lt;-</span> PBS <span class="sc">|&gt;</span></span>
<span id="cb204-2"><a href="seasonal-arima.html#cb204-2" tabindex="-1"></a>  <span class="fu">filter</span>(ATC2 <span class="sc">==</span> <span class="st">&quot;H02&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb204-3"><a href="seasonal-arima.html#cb204-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Cost =</span> <span class="fu">sum</span>(Cost)<span class="sc">/</span><span class="fl">1e6</span>)</span>
<span id="cb204-4"><a href="seasonal-arima.html#cb204-4" tabindex="-1"></a>h02 <span class="sc">|&gt;</span></span>
<span id="cb204-5"><a href="seasonal-arima.html#cb204-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">log</span>(Cost)) <span class="sc">|&gt;</span></span>
<span id="cb204-6"><a href="seasonal-arima.html#cb204-6" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>Month) <span class="sc">|&gt;</span></span>
<span id="cb204-7"><a href="seasonal-arima.html#cb204-7" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Month, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb204-8"><a href="seasonal-arima.html#cb204-8" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb204-9"><a href="seasonal-arima.html#cb204-9" tabindex="-1"></a>  <span class="fu">facet_grid</span>(name <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb204-10"><a href="seasonal-arima.html#cb204-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">&quot;&quot;</span>, <span class="at">title=</span><span class="st">&quot;Corticosteroid drug scripts (H02)&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:h02"></span>
<img src="fpp_files/figure-html/h02-1.png" alt="Corticosteroid drug sales in Australia (in millions of scripts per month). Logged data shown in bottom panel." width="100%" />
<p class="caption">
Figure 9.23: Corticosteroid drug sales in Australia (in millions of scripts per month). Logged data shown in bottom panel.
</p>
</div>
<p>Data from July 1991 to June 2008 are plotted in Figure <a href="seasonal-arima.html#fig:h02">9.23</a>. There is a small increase in the variance with the level, so we take logarithms to stabilise the variance.</p>
<p>The data are strongly seasonal and obviously non-stationary, so seasonal differencing will be used. The seasonally differenced data are shown in Figure <a href="seasonal-arima.html#fig:h02b">9.24</a>. It is not clear at this point whether we should do another difference or not. We decide not to, but the choice is not obvious.</p>
<p>The last few observations appear to be different (more variable) from the earlier data. This may be due to the fact that data are sometimes revised when earlier sales are reported late.</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="seasonal-arima.html#cb205-1" tabindex="-1"></a>h02 <span class="sc">|&gt;</span> <span class="fu">gg_tsdisplay</span>(<span class="fu">difference</span>(<span class="fu">log</span>(Cost), <span class="dv">12</span>),</span>
<span id="cb205-2"><a href="seasonal-arima.html#cb205-2" tabindex="-1"></a>                     <span class="at">plot_type=</span><span class="st">&#39;partial&#39;</span>, <span class="at">lag_max =</span> <span class="dv">24</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:h02b"></span>
<img src="fpp_files/figure-html/h02b-1.png" alt="Seasonally differenced corticosteroid drug sales in Australia (in millions of scripts per month)." width="100%" />
<p class="caption">
Figure 9.24: Seasonally differenced corticosteroid drug sales in Australia (in millions of scripts per month).
</p>
</div>
<p>In the plots of the seasonally differenced data, there are spikes in the PACF at lags 12 and 24, but nothing at seasonal lags in the ACF. This may be suggestive of a seasonal AR(2) term. In the non-seasonal lags, there are three significant spikes in the PACF, suggesting a possible AR(3) term. The pattern in the ACF is not indicative of any simple model.</p>
<p>Consequently, this initial analysis suggests that a possible model for these data is an ARIMA(3,0,0)(2,1,0)<span class="math inline">\(_{12}\)</span>. We fit this model, along with some variations on it, and compute the AICc values shown in Table <a href="seasonal-arima.html#tab:h02aicc">9.2</a>.</p>
<table>
<caption><span id="tab:h02aicc">Table 9.2: </span>AICc values for various ARIMA models applied for H02 monthly script sales data.</caption>
<thead>
<tr class="header">
<th align="center">Model</th>
<th align="center">AICc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">ARIMA(3,0,1)(0,1,2)<span class="math inline">\(_{12}\)</span></td>
<td align="center">-485.5</td>
</tr>
<tr class="even">
<td align="center">ARIMA(3,0,1)(1,1,1)<span class="math inline">\(_{12}\)</span></td>
<td align="center">-484.2</td>
</tr>
<tr class="odd">
<td align="center">ARIMA(3,0,1)(0,1,1)<span class="math inline">\(_{12}\)</span></td>
<td align="center">-483.7</td>
</tr>
<tr class="even">
<td align="center">ARIMA(3,0,1)(2,1,0)<span class="math inline">\(_{12}\)</span></td>
<td align="center">-476.3</td>
</tr>
<tr class="odd">
<td align="center">ARIMA(3,0,0)(2,1,0)<span class="math inline">\(_{12}\)</span></td>
<td align="center">-475.1</td>
</tr>
<tr class="even">
<td align="center">ARIMA(3,0,2)(2,1,0)<span class="math inline">\(_{12}\)</span></td>
<td align="center">-474.9</td>
</tr>
<tr class="odd">
<td align="center">ARIMA(3,0,1)(1,1,0)<span class="math inline">\(_{12}\)</span></td>
<td align="center">-463.4</td>
</tr>
</tbody>
</table>
<p>Of these models, the best is the ARIMA(3,0,1)(0,1,2)<span class="math inline">\(_{12}\)</span> model (i.e., it has the smallest AICc value). The innovation residuals from this model are shown in Figure <a href="seasonal-arima.html#fig:h02res">9.25</a>.</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="seasonal-arima.html#cb206-1" tabindex="-1"></a>fit <span class="ot">&lt;-</span> h02 <span class="sc">|&gt;</span></span>
<span id="cb206-2"><a href="seasonal-arima.html#cb206-2" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ARIMA</span>(<span class="fu">log</span>(Cost) <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> <span class="fu">pdq</span>(<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">+</span> <span class="fu">PDQ</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>)))</span>
<span id="cb206-3"><a href="seasonal-arima.html#cb206-3" tabindex="-1"></a>fit <span class="sc">|&gt;</span> <span class="fu">gg_tsresiduals</span>(<span class="at">lag_max=</span><span class="dv">36</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:h02res"></span>
<img src="fpp_files/figure-html/h02res-1.png" alt="Innovation residuals from the ARIMA(3,0,1)(0,1,2)$_{12}$ model applied to the H02 monthly script sales data." width="100%" />
<p class="caption">
Figure 9.25: Innovation residuals from the ARIMA(3,0,1)(0,1,2)<span class="math inline">\(_{12}\)</span> model applied to the H02 monthly script sales data.
</p>
</div>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="seasonal-arima.html#cb207-1" tabindex="-1"></a><span class="fu">augment</span>(fit) <span class="sc">|&gt;</span></span>
<span id="cb207-2"><a href="seasonal-arima.html#cb207-2" tabindex="-1"></a>  <span class="fu">features</span>(.innov, ljung_box, <span class="at">lag =</span> <span class="dv">36</span>, <span class="at">dof =</span> <span class="dv">6</span>)</span>
<span id="cb207-3"><a href="seasonal-arima.html#cb207-3" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1 × 3</span></span>
<span id="cb207-4"><a href="seasonal-arima.html#cb207-4" tabindex="-1"></a><span class="co">#&gt;   .model                                             lb_stat lb_pvalue</span></span>
<span id="cb207-5"><a href="seasonal-arima.html#cb207-5" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;                                                &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span id="cb207-6"><a href="seasonal-arima.html#cb207-6" tabindex="-1"></a><span class="co">#&gt; 1 ARIMA(log(Cost) ~ 0 + pdq(3, 0, 1) + PDQ(0, 1, 2))    50.7    0.0104</span></span></code></pre></div>
<p>There are a few significant spikes in the ACF, and the model fails the Ljung-Box test. The model can still be used for forecasting, but the prediction intervals may not be accurate due to the correlated residuals.</p>
<p>Next we will try using the automatic ARIMA algorithm. Running <code>ARIMA()</code> with all arguments left at their default values led to an ARIMA(2,1,0)(0,1,1)<span class="math inline">\(_{12}\)</span> model. Running <code>ARIMA()</code> with <code>stepwise=FALSE</code> and <code>approximation=FALSE</code> gives an ARIMA(2,1,3)(0,1,1)<span class="math inline">\(_{12}\)</span> model. However, both models still fail the Ljung-Box test for 36 lags. Sometimes it is just not possible to find a model that passes all of the tests.</p>
</div>
<div id="test-set-evaluation" class="section level3 unnumbered hasAnchor">
<h3>Test set evaluation:<a href="seasonal-arima.html#test-set-evaluation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We will compare some of the models fitted so far using a test set consisting of the last two years of data. Thus, we fit the models using data from July 1991 to June 2006, and forecast the script sales for July 2006 – June 2008. The results are summarised in Table <a href="seasonal-arima.html#tab:h02search">9.3</a>.</p>
<table>
<caption><span id="tab:h02search">Table 9.3: </span>RMSE values for various ARIMA models applied for H02 monthly script sales data over test set July 2006 – June 2008.</caption>
<thead>
<tr class="header">
<th align="center">.model</th>
<th align="center">RMSE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">ARIMA(3,0,1)(1,1,1)<span class="math inline">\(_{12}\)</span></td>
<td align="center">0.0619</td>
</tr>
<tr class="even">
<td align="center">ARIMA(3,0,1)(0,1,2)<span class="math inline">\(_{12}\)</span></td>
<td align="center">0.0621</td>
</tr>
<tr class="odd">
<td align="center">ARIMA(2,1,1)(0,1,1)<span class="math inline">\(_{12}\)</span></td>
<td align="center">0.0622</td>
</tr>
<tr class="even">
<td align="center">ARIMA(2,1,2)(0,1,1)<span class="math inline">\(_{12}\)</span></td>
<td align="center">0.0623</td>
</tr>
<tr class="odd">
<td align="center">ARIMA(2,1,4)(0,1,1)<span class="math inline">\(_{12}\)</span></td>
<td align="center">0.0627</td>
</tr>
<tr class="even">
<td align="center">ARIMA(2,1,3)(0,1,1)<span class="math inline">\(_{12}\)</span></td>
<td align="center">0.0628</td>
</tr>
<tr class="odd">
<td align="center">ARIMA(3,0,1)(0,1,1)<span class="math inline">\(_{12}\)</span></td>
<td align="center">0.0630</td>
</tr>
<tr class="even">
<td align="center">ARIMA(3,0,2)(0,1,1)<span class="math inline">\(_{12}\)</span></td>
<td align="center">0.0630</td>
</tr>
<tr class="odd">
<td align="center">ARIMA(2,1,0)(0,1,1)<span class="math inline">\(_{12}\)</span></td>
<td align="center">0.0630</td>
</tr>
<tr class="even">
<td align="center">ARIMA(3,0,1)(0,1,3)<span class="math inline">\(_{12}\)</span></td>
<td align="center">0.0630</td>
</tr>
<tr class="odd">
<td align="center">ARIMA(3,0,3)(0,1,1)<span class="math inline">\(_{12}\)</span></td>
<td align="center">0.0633</td>
</tr>
<tr class="even">
<td align="center">ARIMA(3,0,2)(2,1,0)<span class="math inline">\(_{12}\)</span></td>
<td align="center">0.0651</td>
</tr>
<tr class="odd">
<td align="center">ARIMA(3,0,1)(2,1,0)<span class="math inline">\(_{12}\)</span></td>
<td align="center">0.0653</td>
</tr>
<tr class="even">
<td align="center">ARIMA(2,1,0)(1,1,0)<span class="math inline">\(_{12}\)</span></td>
<td align="center">0.0666</td>
</tr>
<tr class="odd">
<td align="center">ARIMA(3,0,1)(1,1,0)<span class="math inline">\(_{12}\)</span></td>
<td align="center">0.0666</td>
</tr>
<tr class="even">
<td align="center">ARIMA(3,0,0)(2,1,0)<span class="math inline">\(_{12}\)</span></td>
<td align="center">0.0668</td>
</tr>
</tbody>
</table>
<p>The models chosen manually are close to the best model over this test set based on the RMSE values, while those models chosen automatically with <code>ARIMA()</code> are not far behind.</p>
<p>When models are compared using AICc values, it is important that all models have the same orders of differencing. However, when comparing models using a test set, it does not matter how the forecasts were produced — the comparisons are always valid. Consequently, in the table above, we can include some models with only seasonal differencing and some models with both first and seasonal differencing, while in the earlier table containing AICc values, we only compared models with seasonal differencing but no first differencing.</p>
<p>None of the models considered here pass all of the residual tests. In practice, we would normally use the best model we could find, even if it did not pass all of the tests.</p>
<p>Forecasts from the ARIMA(3,0,1)(0,1,2)<span class="math inline">\(_{12}\)</span> model (which has the second lowest RMSE value on the test set, and the best AICc value amongst models with only seasonal differencing) are shown in Figure <a href="seasonal-arima.html#fig:h02f">9.26</a>.</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="seasonal-arima.html#cb208-1" tabindex="-1"></a>h02 <span class="sc">|&gt;</span></span>
<span id="cb208-2"><a href="seasonal-arima.html#cb208-2" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ARIMA</span>(<span class="fu">log</span>(Cost) <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> <span class="fu">pdq</span>(<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">+</span> <span class="fu">PDQ</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>))) <span class="sc">|&gt;</span></span>
<span id="cb208-3"><a href="seasonal-arima.html#cb208-3" tabindex="-1"></a>  <span class="fu">forecast</span>() <span class="sc">|&gt;</span></span>
<span id="cb208-4"><a href="seasonal-arima.html#cb208-4" tabindex="-1"></a>  <span class="fu">autoplot</span>(h02) <span class="sc">+</span></span>
<span id="cb208-5"><a href="seasonal-arima.html#cb208-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">&quot; $AU (millions)&quot;</span>,</span>
<span id="cb208-6"><a href="seasonal-arima.html#cb208-6" tabindex="-1"></a>       <span class="at">title=</span><span class="st">&quot;Corticosteroid drug scripts (H02) sales&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:h02f"></span>
<img src="fpp_files/figure-html/h02f-1.png" alt="Forecasts from the ARIMA(3,0,1)(0,1,2)$_{12}$ model applied to the H02 monthly script sales data." width="100%" />
<p class="caption">
Figure 9.26: Forecasts from the ARIMA(3,0,1)(0,1,2)<span class="math inline">\(_{12}\)</span> model applied to the H02 monthly script sales data.
</p>
</div>
<p></p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="arima-forecasting.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="arima-ets.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
